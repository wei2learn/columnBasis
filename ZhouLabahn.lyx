#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass sig-alternate
\begin_preamble
%\usepackage{yjsco}\journal{JournalofSymbolicComputation}

\renewcommand{\algorithmicrequire}{\textbf{Input:}}\renewcommand{\algorithmicensure}{\textbf{Output:}}
%\renewcommand{\algorithmicensure}{\textbf{if}}\renewcommand{\algorithmicensure}{\textbf{Uses:}}

%\def\diag{\mbox{diag}}\def\cdeg{\qopname\relax n{cdeg}}
\def\MM{\qopname\relax n{MM}}\def\M{\qopname\relax n{M}}
%\def\ord{\qopname\relax n{ord}}

\def\StorjohannTransform{\qopname\relax n{StorjohannTransform}}\def\TransformUnbalanced{\qopname\relax n{TransformUnbalanced}}\def\rowDimension{\qopname\relax n{rowDimension}}\def\columnDimension{\qopname\relax n{columnDimension}}\DeclareMathOperator{\re}{rem}\DeclareMathOperator{\coeff}{coeff}\DeclareMathOperator{\lcoeff}{lcoeff}\def\mab{\qopname\relax n{orderBasis}}\def\mmab{\qopname\relax n{FastBasis}}\def\umab{\qopname\relax n{UnbalancedFastOrderBasis}}\newcommand{\bb}{\\}
\DeclareMathOperator{\mnbr}{MinimalKernelBasisReversed}
%\def\rdeg{\qopname\relax n{rdeg}}
%\DeclareMathOperator{\colBasis}{colBasis}
\DeclareMathOperator{\colBasis}{ColumnBasis}
\def\mnb{\qopname\relax n{MinimalKernelBasis ~ }}
%\DeclareMathOperator{\mnbr}{DualMinimaKernelBasis}


\newcommand{\arne}[1]{{\color{blue}\it {\bf Arne:} #1 }}
\newcommand{\wei}[1]{{\color{red}\it {\bf Wei:} #1}}
\newcommand{\george}[1]{{\color{green}\it {\bf George:} #1}}
\def\newblock{\hskip .11em plus .33em minus .07em}


\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\K}{ {\rm K}}
\newcommand{\revCol}{ {\rm revCol}}
\newcommand{\bigO}{\mathcal{O}}
\newcommand{\tbigO}{\widetilde{\mathcal{O}}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\ocL}{\overline{\mathcal{L}}}
\newcommand{\tcL}{\widetilde{\mathcal{L}}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\oA}{\overline{A}}
\newcommand{\GL}{{\rm GL}\,}
\newcommand{\rank}{{\rm rank}\,}
\newcommand{\cdeg}{{\rm cdeg}\,}
\newcommand{\rdeg}{{\rm rdeg}\,}
\newcommand{\diag}{{\rm diag}\,}
\newcommand{\val}{{\rm val}\,}
\newcommand{\ord}{{\rm ord}\,}
\newcommand{\abs}[1]{\lvert#1\rvert}


\newrefformat{eq}{\textup{(\ref{#1})}}
\newrefformat{lem}{Lemma \ref{#1}}
\newrefformat{cla}{Claim \ref{#1}}
\newrefformat{thm}{Theorem \ref{#1}}
\newrefformat{cha}{Chapter \ref{#1}}
\newrefformat{sec}{Section \ref{#1}}
\newrefformat{rem}{Remark \ref{#1}}
\newrefformat{fac}{Fact \ref{#1}}
\newrefformat{sub}{Subsection \ref{#1}}
\newrefformat{cor}{Corollary \ref{#1}}
\newrefformat{cond}{Condition \ref{#1}}
\newrefformat{con}{Conjecture \ref{#1}}
\newrefformat{def}{Definition \ref{#1}}
\newrefformat{pro}{Proposition \ref{#1}}
\newrefformat{alg}{Algorithm \ref{#1}}
\newrefformat{exm}{Example \ref{#1}}
\newrefformat{line}{line \ref{#1}}
\newrefformat{tab}{Table \ref{#1} on page \pageref{#1}}
\newrefformat{fig}{Figure \ref{#1} on page \pageref{#1}}
\end_preamble
\use_default_options false
\begin_modules
algorithmics
\end_modules
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding latin9
\fontencoding T1
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 2
\use_esint 1
\use_mhchem 0
\use_mathdots 0
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% --- Author Metadata here ---
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
conferenceinfo{ISSAC'09,} {July 28--31, 2009, Seoul, Republic of Korea.}
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
CopyrightYear{2009}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
crdata{978-1-60558-609-0/09/07} 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
numberofauthors
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

1
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Author
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
alignauthor
\end_layout

\end_inset

 Wei Zhou and George Labahn
\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
affaddr
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Cheriton School of Computer Science
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
affaddr
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

University of Waterloo
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

, 
\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
affaddr
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Waterloo, Ontario, Canada
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
email
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

{w2zhou,glabahn}@uwaterloo.ca
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Date

\size normal
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
today
\end_layout

\end_inset

 
\begin_inset space \quad{}
\end_inset

:: 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
timeofday
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Title
Computation of Column Bases of Polynomial Matrices
\end_layout

\begin_layout Abstract
Given a matrix of univariate polynomials over a field 
\begin_inset Formula $\mathbb{K}$
\end_inset

, its columns generate a 
\begin_inset Formula $\mathbb{K}\left[x\right]$
\end_inset

-module.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% consisting of all $
\backslash
mathbb{K}
\backslash
left[x
\backslash
right]$-linear combination of these columns.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%This module is used for such important computations as matrix GCDs and
 matrix normal forms for %polynomial matrices.
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

We call any basis of this module a column basis of the given matrix.
 Matrix gcds and matrix normal forms are examples of such module bases.
 In this paper we present a deterministic algorithm for the computation
 of a column basis of an 
\begin_inset Formula $m\times n$
\end_inset

 input matrix with 
\begin_inset Formula $m\le n$
\end_inset

.
 If 
\begin_inset Formula $s$
\end_inset

 is the average column degree of the input matrix, this algorithm computes
 a column basis with a cost of 
\begin_inset Formula $O^{\sim}\left(nm^{\omega-1}s\right)$
\end_inset

 field operations in 
\begin_inset Formula $\mathbb{K}$
\end_inset

.
 Here the soft-
\begin_inset Formula $O$
\end_inset

 notation is Big-
\begin_inset Formula $O$
\end_inset

 with log factors removed while 
\begin_inset Formula $\omega$
\end_inset

 is the exponent of matrix multiplication.
 Note that the average column degree 
\begin_inset Formula $s$
\end_inset

 is bounded by the commonly used matrix degree that is also the maximum
 column degree of the input matrix.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% A category with the (minimum) three required fields
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
category{I.1.2}{Symbolic and Algebraic Manipulation}{Algorithms}%[Algebraic
 algorithms]
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%A category including the fourth, optional field follows...
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
category{F.2.2}{Analysis of Algorithms and }{Nonnumerical Algorithms and Problems}
%[Computations on discrete structures]
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
terms{Algorithms, Theory}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%
\backslash
keywords{Order basis, Complexity}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 1mm
\end_inset

 
\series bold
Categories and Subject Descriptors:
\series default
 I.1.2 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

[
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Symbolic and Algebraic Manipulation
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

: 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Algorithms
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

; F.2.2 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

[
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Analysis of Algorithms and Problem Complexity
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

: 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Nonnumerical Algorithms and Problems
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset VSpace 1mm
\end_inset

 
\series bold
General Terms:
\series default
 Algorithms, Theory
\end_layout

\begin_layout Standard
\noindent
\begin_inset VSpace 1mm
\end_inset

 
\series bold
Keywords:
\series default
 Order Basis, Kernel basis, Nullspace basis, Column Basis
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Matrix-GCD"

\end_inset

Introduction
\end_layout

\begin_layout Standard
\noindent
In this paper, we consider the problem of efficiently computing a column
 basis of a polynomial matrix 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 with 
\begin_inset Formula $n\ge m$
\end_inset

.
 A column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is a basis for the 
\begin_inset Formula $\mathbb{K}\left[x\right]$
\end_inset

-module 
\begin_inset Formula 
\[
\left\{ \mathbf{F}\mathbf{p}~|~\mathbf{p}\in\mathbb{K}\left[x\right]^{n}~\right\} ~.
\]

\end_inset

Such a basis can be represented as a full rank matrix 
\begin_inset Formula $\mathbf{T}\in\mathbb{K}\left[x\right]^{m\times r}$
\end_inset

 whose columns are the basis elements.
 A column basis is not unique and indeed any column basis right multiplied
 by a unimodular polynomial matrix gives another column basis.
 As a result, a column basis can have arbitrarily high degree.
 In this paper, the computed column basis has column degrees bounded by
 the largest column degrees of the input matrix.
\end_layout

\begin_layout Standard
Column bases are fundamental constructions in polynomial matrix algebra.
 As an example, when the row dimension is one (i.e.
 
\begin_inset Formula $m=1$
\end_inset

), then finding a column basis coincides with finding a greatest common
 divisor (GCD) of all the polynomials in the matrix.
 Similarly, the nonzero columns of column reduced forms, Popov normal forms,
 and Hermite normal forms are all column bases satisfying additional degree
 constraints.
 A column reduced form gives a special column basis whose column degrees
 are the smallest possible, while Popov and Hermite forms are special column
 reduced or shifted column reduced forms satisfying additional conditions
 that make them unique.
 Efficient column basis computation is thus useful for fast computation
 for such core procedures as determining matrix GCDs 
\begin_inset CommandInset citation
LatexCommand cite
key "BL2000"

\end_inset

, column reduced forms 
\begin_inset CommandInset citation
LatexCommand cite
key "BVP:1988"

\end_inset

 and Popov forms 
\begin_inset CommandInset citation
LatexCommand cite
key "villard96"

\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 with any dimension and rank.
 Column basis computation 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%in this paper 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

also provides a deterministic alternative to randomized lattice compression
 
\begin_inset CommandInset citation
LatexCommand cite
key "li:2006,storjohann-villard:2005"

\end_inset

.
\end_layout

\begin_layout Standard
Column bases are produced by column reduced, Popov and Hermite forms and
 considerable work has been done on computing such forms, for example 
\begin_inset CommandInset citation
LatexCommand cite
key "bcl:2006,Giorgi2003,GSSV2012,sarkar2011,SS2011"

\end_inset

.
 However most of these existing algorithms require that the input matrices
 be square nonsingular and so start with existing column bases.
 It is however pointed out in 
\begin_inset CommandInset citation
LatexCommand cite
key "sarkar2011,SS2011"

\end_inset

 that randomization can be used to relax the square nonsingular requirement.
\end_layout

\begin_layout Standard
To compute a column basis, we know from 
\begin_inset CommandInset citation
LatexCommand cite
key "BL1997"

\end_inset

 that any matrix polynomial 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 can be unimodularly transformed to a column basis by repeatedly working
 with the leading column coefficient matrices.
 However this method of computing a column basis can be expensive.
 Indeed one needs to work with up to 
\begin_inset Formula $\sum\vec{s}$
\end_inset

 such coefficient matrices, which could involve up to 
\begin_inset Formula $\sum\vec{s}$
\end_inset

 polynomial matrix multiplications, where a sum without index denotes the
 sum of all entries.
\end_layout

\begin_layout Standard
In this paper we give a fast, deterministic algorithm for the computation
 of a column basis for 
\begin_inset Formula $\mathbf{F}$
\end_inset

 having complexity 
\begin_inset Formula $O^{\sim}\left(nm^{\omega-1}s\right)$
\end_inset

 field operations in 
\begin_inset Formula $\mathbb{K}$
\end_inset

 with 
\begin_inset Formula $s$
\end_inset

 being the average column degree of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Here the soft-
\begin_inset Formula $O$
\end_inset

 notation is Big-
\begin_inset Formula $O$
\end_inset

 with log factors removed while 
\begin_inset Formula $\omega$
\end_inset

 is the exponent of matrix multiplication.
 Our algorithm works for both rectangular and non-full column rank matrices.
 Our method depends on kernel basis computation of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 along with finding a factorization of the input matrix polynomial into
 a column basis and a left kernel basis of a right kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Finding the right and left kernel basis then makes use of the fast kernel
 basis and order basis algorithms from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "za2009,ZL2012"

\end_inset

, respectively.
 
\end_layout

\begin_layout Standard
The remainder of this paper is as follows.
 Basic definitions and preliminary results on both kernel and order bases
 are given in the next section.
 Section 3 provides the matrix factorization form of our input polynomial
 matrix that forms the core of our procedure, with a column basis being
 the left factor, and the right factor is a left kernel basis of a right
 kernel basis of the input matrix.
 Section 4 provides an algorithm for fast computation of a left kernel basis
 making use of order bases computation with unbalanced shift.
 The column basis algorithm is given in Section 5 with the following section
 giving details on how the methods can be improved when the number of columns
 is significantly larger than the number of rows.
 The paper ends with a conclusion along with topics for future research.
\end_layout

\begin_layout Section
Preliminaries
\end_layout

\begin_layout Standard
In this paper computational cost is analyzed by bounding the number of arithmeti
c operations in the coefficient field 
\begin_inset Formula $\mathbb{K}$
\end_inset

 on an algebraic random access machine.
 We assume the cost of multiplying two polynomial matrices with dimension
 
\begin_inset Formula $n$
\end_inset

 and degree 
\begin_inset Formula $d$
\end_inset

 is 
\begin_inset Formula $O^{\sim}(n^{\omega}d)$
\end_inset

 field operations, where the multiplication exponent 
\begin_inset Formula $\omega$
\end_inset

 is assumed to satisfy 
\begin_inset Formula $2<\omega\le3$
\end_inset

.
 We refer to the book by 
\begin_inset CommandInset citation
LatexCommand cite
key "vonzurgathen"

\end_inset

 for more details and references about the cost of polynomial multiplication
 and matrix multiplication.
\end_layout

\begin_layout Standard
In this section we first describe the notations used in this paper, and
 then give the basic definitions and properties of 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
em
\end_layout

\end_inset

 shifted degree
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

, 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
em
\end_layout

\end_inset

 order basis
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
em
\end_layout

\end_inset

 kernel basis
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 for a matrix of polynomials.
 These will be the building blocks used in our algorithm.
\end_layout

\begin_layout Subsection
Notations
\end_layout

\begin_layout Standard
For convenience we adopt the following notations in this paper.
 
\end_layout

\begin_layout Description
Comparing
\begin_inset space ~
\end_inset

Unordered
\begin_inset space ~
\end_inset

Lists For two lists 
\begin_inset Formula $\vec{a}\in\mathbb{Z}^{n}$
\end_inset

 and 
\begin_inset Formula $\vec{b}\in\mathbb{Z}^{n}$
\end_inset

, let 
\begin_inset Formula $\bar{a}=\left[\bar{a}_{1},\dots,\bar{a}_{n}\right]\in\mathbb{Z}^{n}$
\end_inset

 and 
\begin_inset Formula $\bar{b}=\left[\bar{b}_{1},\dots,\bar{b}_{n}\right]\in\mathbb{Z}^{n}$
\end_inset

 be the lists consists of the entries of 
\begin_inset Formula $\vec{a}$
\end_inset

 and 
\begin_inset Formula $\vec{b}$
\end_inset

 but sorted in increasing order.
 
\begin_inset Formula 
\[
\begin{cases}
\vec{a}\ge\vec{b} & \mbox{if }\bar{a}_{i}\ge\bar{b}_{i}\mbox{ for all }i\in\left[1,\dots n\right]\\
\vec{a}\le\vec{b} & \mbox{if }\bar{a}_{i}\le\bar{b}_{i}\mbox{ for all }i\in\left[1,\dots n\right]\\
\vec{a}>\vec{b} & \mbox{if }\vec{a}\ge\vec{b}\mbox{ and }\bar{a}_{j}>\bar{b}_{j}\mbox{ for at least one }j\in\left[1,\dots n\right]\\
\vec{a}<\vec{b} & \mbox{if }\vec{a}\le\vec{b}\mbox{ and }\bar{a}_{j}<\bar{b}_{j}\mbox{ for at least one }j\in\left[1,\dots n\right].
\end{cases}
\]

\end_inset


\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Summation
\begin_inset space ~
\end_inset

Notation For a list 
\begin_inset Formula $\vec{a}=\left[a_{1},\dots,a_{n}\right]\in\mathbb{Z}^{n}$
\end_inset

, we write 
\begin_inset Formula $\sum\vec{a}$
\end_inset

 without index to denote the summation of all entries in 
\begin_inset Formula $\vec{a}$
\end_inset

.
 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
item [{}]~
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Description
Uniformly
\begin_inset space ~
\end_inset

Shift
\begin_inset space ~
\end_inset

a
\begin_inset space ~
\end_inset

List For a list 
\begin_inset Formula $\vec{a}=\left[a_{1},\dots,a_{n}\right]\in\mathbb{Z}^{n}$
\end_inset

 and 
\begin_inset Formula $c\in\mathbb{Z}$
\end_inset

, we write 
\begin_inset Formula $\vec{a}+c$
\end_inset

 to denote 
\begin_inset Formula $\vec{a}+\left[c,\dots,c\right]=\left[a_{1}+c,\dots,a_{n}+c\right]$
\end_inset

, with subtraction handled similarly.
 
\end_layout

\begin_layout Description
Compare
\begin_inset space ~
\end_inset

a
\begin_inset space ~
\end_inset

List
\begin_inset space ~
\end_inset

with
\begin_inset space ~
\end_inset

a
\begin_inset space ~
\end_inset

Integer For 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%a list 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula $\vec{a}=\left[a_{1},\dots,a_{n}\right]\in\mathbb{Z}^{n}$
\end_inset

 and 
\begin_inset Formula $c\in\mathbb{Z}$
\end_inset

, we write 
\begin_inset Formula $\vec{a}<c$
\end_inset

 to denote 
\begin_inset Formula $\vec{a}<\left[c,\dots,c\right]$
\end_inset

, and similarly for 
\begin_inset Formula $>,\le,\ge,=$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Shifted Degrees
\end_layout

\begin_layout Standard
Our methods depend extensively on the concept of 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
em
\end_layout

\end_inset

 shifted
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 degrees of polynomial matrices 
\begin_inset CommandInset citation
LatexCommand cite
key "BLV:1999"

\end_inset

.
 For a column vector 
\begin_inset Formula $\mathbf{p}=\left[p_{1},\dots,p_{n}\right]^{T}$
\end_inset

 of univariate polynomials over a field 
\begin_inset Formula $\mathbb{K}$
\end_inset

, its column degree, denoted by 
\begin_inset Formula $\cdeg\mathbf{p}$
\end_inset

, is the maximum of the degrees of the entries of 
\begin_inset Formula $\mathbf{p}$
\end_inset

, that is, 
\begin_inset Formula 
\[
\cdeg~\mathbf{p}=\max_{1\le i\le n}\deg p_{i}.
\]

\end_inset

The 
\emph on
shifted column degree
\emph default
 generalizes this standard column degree by taking the maximum after shifting
 the degrees by a given integer vector that is known as a 
\emph on
shift
\emph default
.
 More specifically, the shifted column degree of 
\begin_inset Formula $\mathbf{p}$
\end_inset

 with respect to a shift 
\begin_inset Formula $\vec{s}=\left[s_{1},\dots,s_{n}\right]\in\mathbb{Z}^{n}$
\end_inset

, or the 
\emph on

\begin_inset Formula $\vec{s}$
\end_inset

-column degree
\emph default
 of 
\begin_inset Formula $\mathbf{p}$
\end_inset

 is 
\begin_inset Formula 
\[
\cdeg_{\vec{s}}~\mathbf{p}=\max_{1\le i\le n}[\deg p_{i}+s_{i}]=\deg(x^{\vec{s}}\cdot\mathbf{p}),
\]

\end_inset

where 
\begin_inset Formula $x^{\vec{s}}=\diag\left(x^{s_{1}},x^{s_{2}},\dots,x^{s_{n}}\right).$
\end_inset

 For a matrix 
\begin_inset Formula $\mathbf{P}$
\end_inset

, we use 
\begin_inset Formula $\cdeg\mathbf{P}$
\end_inset

 and 
\begin_inset Formula $\cdeg_{\vec{s}}\mathbf{P}$
\end_inset

 to denote respectively the list of its column degrees and the list of its
 shifted 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees.
 When 
\begin_inset Formula $\vec{s}=\left[0,\dots,0\right]$
\end_inset

, the shifted column degree specializes to the standard column degree.
 The shifted row degree of a row vector 
\series bold

\begin_inset Formula $\mathbf{q}=\left[q_{1},\dots,q_{n}\right]$
\end_inset


\series default
 is defined similarly as 
\begin_inset Formula 
\[
\rdeg_{\vec{s}}\mathbf{q}=\max_{1\le i\le n}[\deg q_{i}+s_{i}]=\deg(\mathbf{q}\cdot x^{\vec{s}}).
\]

\end_inset


\end_layout

\begin_layout Standard
Shifted degrees have been used previously in polynomial matrix computations
 and in generalizations of some matrix normal forms 
\begin_inset CommandInset citation
LatexCommand cite
key "BLV:jsc06"

\end_inset

.
 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
The shifted column degree is equivalent to the notion of 
\emph on
defect
\emph default
 commonly used in the literature.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The usefulness of the shifted degrees can be seen from their applications
 in polynomial matrix computation problems 
\begin_inset CommandInset citation
LatexCommand cite
key "ZL2012,za2012"

\end_inset

.
 One of its uses is illustrated by the following lemma from 
\begin_inset CommandInset citation
LatexCommand cite
after "Chapter 2"
key "zhou:phd2012"

\end_inset

, which can be viewed as a stronger version of the predictable-degree property
 
\begin_inset CommandInset citation
LatexCommand cite
key "kailath:1980"

\end_inset

.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:predictableDegree"

\end_inset

Let 
\begin_inset Formula $\mathbf{A}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 be a 
\begin_inset Formula $\vec{u}$
\end_inset

-column reduced matrix with no zero columns and with 
\begin_inset Formula $\cdeg_{\vec{u}}\mathbf{A}=\vec{v}$
\end_inset

.
 Then a matrix 
\begin_inset Formula $\mathbf{B}\in\mathbb{K}\left[x\right]^{n\times k}$
\end_inset

 has 
\begin_inset Formula $\vec{v}$
\end_inset

-column degrees 
\begin_inset Formula $\cdeg_{\vec{v}}\mathbf{B}=\vec{w}$
\end_inset

 if and only if 
\begin_inset Formula $\cdeg_{\vec{u}}\left(\mathbf{A}\mathbf{B}\right)=\vec{w}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The following lemma from 
\begin_inset CommandInset citation
LatexCommand cite
after "Chapter 2"
key "zhou:phd2012"

\end_inset

 describes a relationship between shifted column degrees and shifted row
 degrees.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:columnDegreesRowDegreesSymmetry"

\end_inset

A matrix 
\begin_inset Formula $\mathbf{A}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 has 
\begin_inset Formula $\vec{u}$
\end_inset

-column degrees bounded by 
\begin_inset Formula $\vec{v}$
\end_inset

 if and only if its 
\begin_inset Formula $-\vec{v}$
\end_inset

-row degrees are bounded by 
\begin_inset Formula $-\vec{u}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Another essential fact needed in our algorithm, also based on the use of
 the shifted degrees, is the efficient multiplication of matrices with unbalance
d degrees 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem 3.7"
key "za2012"

\end_inset

.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:multiplyUnbalancedMatrices"

\end_inset

 Let 
\begin_inset Formula $\mathbf{A}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 with 
\begin_inset Formula $m\le n$
\end_inset

, 
\begin_inset Formula $\vec{s}\in\mathbb{Z}^{n}$
\end_inset

 a shift with entries bounding the column degrees of 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\xi$
\end_inset

, a bound on the sum of the entries of 
\begin_inset Formula $\vec{s}$
\end_inset

.
 Let 
\begin_inset Formula $\mathbf{B}\in\mathbb{K}\left[x\right]^{n\times k}$
\end_inset

 with 
\begin_inset Formula $k\in O\left(m\right)$
\end_inset

 and the sum 
\begin_inset Formula $\theta$
\end_inset

 of its 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees satisfying 
\begin_inset Formula $\theta\in O\left(\xi\right)$
\end_inset

.
 Then we can multiply 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\mathbf{B}$
\end_inset

 with a cost of 
\begin_inset Formula $O^{\sim}(n^{2}m^{\omega-2}s)\subset O^{\sim}(n^{\omega}s)$
\end_inset

, where 
\begin_inset Formula $s=\xi/n$
\end_inset

 is the average of the entries of 
\begin_inset Formula $\vec{s}$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Order Basis
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbb{K}$
\end_inset

 be a field, 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[\left[x\right]\right]^{m\times n}$
\end_inset

 a matrix of power series and 
\begin_inset Formula $\vec{\sigma}=\left[\sigma_{1},\dots,\sigma_{m}\right]$
\end_inset

 a vector of non-negative integers.
 
\end_layout

\begin_layout Definition
A vector of polynomials 
\begin_inset Formula $\mathbf{p}\in\mathbb{K}\left[x\right]^{n\times1}$
\end_inset

 has 
\emph on
order
\emph default
 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

 (or 
\emph on
order
\emph default
 
\begin_inset Formula $\vec{\sigma}$
\end_inset

 with respect to 
\begin_inset Formula $\mathbf{F}$
\end_inset

) if 
\begin_inset Formula $\mathbf{F}\cdot\mathbf{p}\equiv\mathbf{0}\mod x^{\vec{\sigma}}$
\end_inset

, that is, 
\begin_inset Formula 
\[
\mathbf{F}\cdot\mathbf{p}=x^{\vec{\sigma}}\mathbf{r}
\]

\end_inset

for some 
\begin_inset Formula $\mathbf{r}\in\mathbb{K}\left[\left[x\right]\right]^{m\times1}$
\end_inset

.
 If 
\begin_inset Formula $\vec{\sigma}=\left[\sigma,\dots,\sigma\right]$
\end_inset

 has entries uniformly equal to 
\begin_inset Formula $\sigma$
\end_inset

, then we say that 
\begin_inset Formula $\mathbf{p}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right).$
\end_inset

 The set of all order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

 vectors is a free 
\begin_inset Formula $\mathbb{K}\left[x\right]$
\end_inset

-module denoted by 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

.
 
\end_layout

\begin_layout Standard
An order basis for 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\vec{\sigma}$
\end_inset

 is simply a basis for the 
\begin_inset Formula $\mathbb{K}\left[x\right]$
\end_inset

-module 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

.
 We again represent order bases using matrices, whose columns are the basis
 elements.
 We only work with those order bases having minimal or shifted minimal degrees
 (also referred to as a reduced order basis in 
\begin_inset CommandInset citation
LatexCommand cite
key "BL1997"

\end_inset

), that is, their column degrees or shifted column degrees are the smallest
 possible among all bases of the module.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%A discussion on such minimality and its existence can be found in 
\backslash
cite[Chapter 2]{zhou:phd2012}.
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
An order basis 
\begin_inset CommandInset citation
LatexCommand cite
key "BeLa94,BL1997"

\end_inset

 
\begin_inset Formula $\mathbf{P}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 with order 
\begin_inset Formula $\vec{\sigma}$
\end_inset

 and shift 
\begin_inset Formula $\vec{s}$
\end_inset

, or simply an 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis, is a basis for the module 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 having minimal 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees.
 If 
\begin_inset Formula $\vec{\sigma}=\left[\sigma,\dots,\sigma\right]$
\end_inset

 is uniform then we simply write 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 The precise definition of an 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis is as follows.
 
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:orderBasis"

\end_inset

A polynomial matrix 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is an order basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 of order 
\begin_inset Formula $\vec{\sigma}$
\end_inset

 and shift 
\begin_inset Formula $\vec{s}$
\end_inset

, denoted by 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis, if the following properties hold: 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 is a nonsingular matrix of dimension 
\begin_inset Formula $n$
\end_inset

 and is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

 (or equivalently, each column of 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is in 
\begin_inset Formula $\left\langle (\mathbf{F},\vec{\sigma})\right\rangle $
\end_inset

).
 
\end_layout

\begin_layout Enumerate
Any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 can be expressed as a linear combination of the columns of 
\begin_inset Formula $\mathbf{P}$
\end_inset

, given by 
\begin_inset Formula $\mathbf{P}^{-1}\mathbf{q}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
begin{comment}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%Note that the module $
\backslash
left
\backslash
langle 
\backslash
left(
\backslash
mathbf{F},
\backslash
vec{
\backslash
sigma}
\backslash
right)
\backslash
right
\backslash
rangle $
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%does not depend on the shift $
\backslash
vec{s}$.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
end{comment}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
In this paper, a 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis is also called a 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-order basis to further distinguish it from the kernel basis notation given
 in the following subsection.
 
\end_layout

\begin_layout Standard
Note that any pair of 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-order bases 
\begin_inset Formula $\mathbf{P}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 are column bases of each other and are unimodularly equivalent.
\end_layout

\begin_layout Standard
We will need to compute order bases with unbalanced shifts using Algorithm
 2 from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2009"

\end_inset

.
 This computation can be done efficiently as given by the following result
 from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:unbalancedOrderBasisCost"

\end_inset

If 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%the shift 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula $\vec{s}$
\end_inset

 satisfies 
\begin_inset Formula $\vec{s}\le0$
\end_inset

 and 
\begin_inset Formula $-\sum\vec{s}\le m\sigma$
\end_inset

, then a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis can be computed with a cost of 
\begin_inset Formula $O^{\sim}(n^{\omega}d)$
\end_inset

 field operations, where 
\begin_inset Formula $d=m\sigma/n$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Kernel Bases
\end_layout

\begin_layout Standard
The kernel of 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 is the 
\begin_inset Formula $\mathbb{F}\left[x\right]$
\end_inset

-module 
\begin_inset Formula 
\[
\left\{ \mathbf{p}\in\mathbb{K}\left[x\right]^{n}~|~\mathbf{F}\mathbf{p}=0\right\} 
\]

\end_inset

with a kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 being a basis of this module.
 Kernel bases are closely related to order bases, as can be seen from the
 following definitions.
 
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:kernelBasis"

\end_inset

Given 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

, a polynomial matrix 
\begin_inset Formula $\mathbf{N}\in\mathbb{K}\left[x\right]^{n\times*}$
\end_inset

 is a (right) kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 if the following properties hold: 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathbf{N}$
\end_inset

 is full-rank.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{N}$
\end_inset

 satisfies 
\begin_inset Formula $\mathbf{F}\cdot\mathbf{N}=0$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Any 
\begin_inset Formula $\mathbf{q}\in\mathbb{K}\left[x\right]^{n}$
\end_inset

 satisfying 
\begin_inset Formula $\mathbf{F}\mathbf{q}=0$
\end_inset

 can be expressed as a linear combination of the columns of 
\begin_inset Formula $\mathbf{N}$
\end_inset

, that is, there exists some polynomial vector 
\begin_inset Formula $\mathbf{p}$
\end_inset

 such that 
\begin_inset Formula $\mathbf{q}=\mathbf{N}\mathbf{p}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Standard
Any pair of kernel bases 
\begin_inset Formula $\mathbf{N}$
\end_inset

 and 
\begin_inset Formula $\mathbf{M}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 are column bases of each other and are unimodularly equivalent.
\end_layout

\begin_layout Standard
A 
\begin_inset Formula $\vec{s}$
\end_inset

-minimal kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is just a kernel basis that is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
 
\end_layout

\begin_layout Definition
Given 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

, a polynomial matrix 
\begin_inset Formula $\mathbf{N}\in\mathbb{K}\left[x\right]^{n\times*}$
\end_inset

 is a 
\begin_inset Formula $\vec{s}$
\end_inset

-minimal (right) kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 if
\series bold
 
\begin_inset Formula $\mathbf{N}$
\end_inset


\series default
 is a kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
 We also call a 
\begin_inset Formula $\vec{s}$
\end_inset

-minimal (right) kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 a 
\begin_inset Formula $\left(\mathbf{F},\vec{s}\right)$
\end_inset

-kernel basis.
\end_layout

\begin_layout Standard
In our earlier paper 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

, a minimal kernel basis is called a minimal nullspace basis.
 In this paper, the term kernel basis is now used to emphasize the fact
 that we compute a basis for a 
\begin_inset Formula $\mathbb{F}\left[x\right]$
\end_inset

-module instead of a basis for a 
\begin_inset Formula $\mathbb{F}\left(x\right)$
\end_inset

-vector space, since the term nullspace basis usually refers to a basis
 of some vector space as in 
\begin_inset CommandInset citation
LatexCommand cite
key "storjohann-villard:2005"

\end_inset

.
\end_layout

\begin_layout Standard
We will need to the following result from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

 to bound the sizes of kernel bases.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:boundOfSumOfShiftedDegreesOfKernelBasis"

\end_inset

Suppose 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 and 
\begin_inset Formula $\vec{s}\in\mathbb{Z}_{\ge0}^{n}$
\end_inset

 is a shift with entries bounding the corresponding column degrees of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Then the sum of the 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees of any 
\begin_inset Formula $\vec{s}$
\end_inset

-minimal kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is bounded by 
\begin_inset Formula $\sum\vec{s}$
\end_inset

.
 
\end_layout

\begin_layout Standard
We will also need the following result from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

 to compute kernel bases by rows.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:continueComputingKernelBasisByRows"

\end_inset

Let 
\begin_inset Formula $\mathbf{G}=\left[\mathbf{G}_{1}^{T},\mathbf{G}_{2}^{T}\right]^{T}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 and 
\begin_inset Formula $\vec{t}\in\mathbb{Z}^{n}$
\end_inset

 a shift vector.
 If 
\begin_inset Formula $\mathbf{N}_{1}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{G}_{1},\vec{t}\right)$
\end_inset

-kernel basis with 
\begin_inset Formula $\vec{t}$
\end_inset

-column degrees 
\begin_inset Formula $\vec{u}$
\end_inset

, and 
\begin_inset Formula $\mathbf{N}_{2}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{G}_{2}\mathbf{N}_{1},\vec{u}\right)$
\end_inset

-kernel basis with 
\begin_inset Formula $\vec{u}$
\end_inset

-column degrees 
\begin_inset Formula $\vec{v}$
\end_inset

, then 
\begin_inset Formula $\mathbf{N}_{1}\mathbf{N}_{2}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{G},\vec{t}\right)$
\end_inset

-kernel basis with 
\begin_inset Formula $\vec{t}$
\end_inset

-column degrees 
\begin_inset Formula $\vec{v}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Also recall the cost of kernel basis computation from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:costGeneral"

\end_inset

 Given an input matrix 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

.
 Let 
\begin_inset Formula $\vec{s}=\cdeg\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $s=\sum\vec{s}/n$
\end_inset

 be the average column degree of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Then a 
\begin_inset Formula $\left(\mathbf{F},\vec{s}\right)$
\end_inset

-kernel basis can be computed with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

 field operations.
\end_layout

\begin_layout Section
Column Basis via Factorization
\end_layout

\begin_layout Standard
In this section we reduce the problem of determining a column basis of a
 polynomial matrix into three separate processes.
 For this reduction it turns out to be 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%Before discussing the efficient computation of column basis, it is 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

useful to look at following relationship between column basis, kernel basis,
 and unimodular matrices.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:unimodular_kernel_columnBasis"

\end_inset

 Let 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 and suppose 
\begin_inset Formula $\mathbf{U}\in\mathbb{K}\left[x\right]^{n\times n}$
\end_inset

 is a unimodular matrix such that 
\begin_inset Formula $\mathbf{F}\mathbf{U}=\left[0,\mathbf{T}\right]$
\end_inset

 with 
\begin_inset Formula $\mathbf{T}$
\end_inset

 of full column rank.
 Partition 
\begin_inset Formula $\mathbf{U}=\left[\mathbf{U}_{L},\mathbf{U}_{R}\right]$
\end_inset

 such that 
\begin_inset Formula $\mathbf{F}\cdot\mathbf{U}_{L}=0$
\end_inset

 and 
\begin_inset Formula $\mathbf{F}\mathbf{U}_{R}=\mathbf{T}$
\end_inset

.
 Then 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset

 is a kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\mathbf{T}$
\end_inset

 is a column basis of
\begin_inset space ~
\end_inset


\begin_inset Formula $\mathbf{F}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
If 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is any other kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

, then 
\begin_inset Formula $\mathbf{U}^{*}=\left[\mathbf{N},~\mathbf{U}_{R}\right]$
\end_inset

 is also unimodular and also unimodularly transforms 
\begin_inset Formula $\mathbf{F}$
\end_inset

 to 
\begin_inset Formula $\left[0,\mathbf{T}\right]$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Proof
Since 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\left[0,\mathbf{T}\right]$
\end_inset

 are unimodularly equivalent with 
\begin_inset Formula $\mathbf{T}$
\end_inset

 having full column rank we have that 
\begin_inset Formula $\mathbf{T}$
\end_inset

 is a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 It remains to show that 
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset

 is a kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{F}\mathbf{U}_{L}=0$
\end_inset

, 
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset

 is generated by any kernel basis 
\begin_inset Formula $\mathbf{N}$
\end_inset

, that is, 
\begin_inset Formula $\mathbf{U}_{L}=\mathbf{N}\mathbf{C}$
\end_inset

 for some polynomial matrix 
\begin_inset Formula $\mathbf{C}$
\end_inset

.
 Let 
\begin_inset Formula $r$
\end_inset

 be the rank of 
\begin_inset Formula $\mathbf{F}$
\end_inset

, which is also the column dimension of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{R}$
\end_inset

.
 Then both 
\begin_inset Formula $\mathbf{N}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset

 have column dimension 
\begin_inset Formula $n-r$
\end_inset

.
 Hence 
\begin_inset Formula $\mathbf{C}$
\end_inset

 is a square 
\begin_inset Formula $(n-r)\times(n-r)$
\end_inset

 matrix.
 The unimodular matrix 
\begin_inset Formula $\mathbf{U}$
\end_inset

 can be factored as 
\begin_inset Formula 
\[
\mathbf{U}=\left[\mathbf{N}\mathbf{C},\mathbf{U}_{R}\right]=\left[\mathbf{N},\mathbf{U}_{R}\right]\begin{bmatrix}\mathbf{C} & 0\\
0 & I
\end{bmatrix},
\]

\end_inset

implying that both factors 
\begin_inset Formula $\left[\mathbf{N},\mathbf{U}_{R}\right]$
\end_inset

 and 
\begin_inset Formula $\begin{bmatrix}\mathbf{C} & 0\\
0 & I
\end{bmatrix}$
\end_inset

 are unimodular.
 Therefore, 
\begin_inset Formula $\mathbf{C}$
\end_inset

 is unimodular and 
\begin_inset Formula $\mathbf{U}_{L}=\mathbf{N}\mathbf{C}$
\end_inset

 is also a kernel basis.
 Notice that the unimodular matrix 
\begin_inset Formula $\left[\mathbf{N},\mathbf{U}_{R}\right]$
\end_inset

 also transforms 
\begin_inset Formula $\mathbf{F}$
\end_inset

 to 
\begin_inset Formula $\left[0,\mathbf{T}\right]$
\end_inset

.
 
\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "cor:unimodular_kernel_columnBasis2"

\end_inset

 It is interesting to see what Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:unimodular_kernel_columnBasis"

\end_inset

 implies in the case of unimodular matrices.
 Let 
\begin_inset Formula $\mathbf{U}\in\mathbb{K}\left[x\right]^{n\times n}$
\end_inset

 be a unimodular matrix with inverse 
\begin_inset Formula $\mathbf{V}$
\end_inset

, which, for a given 
\begin_inset Formula $k$
\end_inset

, are partitioned as 
\begin_inset Formula $\mathbf{U}=\left[\mathbf{U}_{L},\mathbf{U}_{R}\right]$
\end_inset

 and 
\begin_inset Formula $\mathbf{V}=\begin{bmatrix}\mathbf{V}_{U}\\
\mathbf{V}_{D}
\end{bmatrix}$
\end_inset

 with 
\begin_inset Formula $\mathbf{U}_{L}\in\mathbb{K}\left[x\right]^{n\times k}$
\end_inset

 and 
\begin_inset Formula $\mathbf{V}_{U}\in\mathbb{K}\left[x\right]^{k\times n}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{U}$
\end_inset

 and 
\begin_inset Formula $\mathbf{V}$
\end_inset

 are inverses of each other we have the identities 
\begin_inset Formula 
\begin{equation}
\mathbf{V}\mathbf{U}=\begin{bmatrix}\mathbf{V}_{U}\mathbf{U}_{L} & \mathbf{V}_{U}\mathbf{U}_{R}\\
\mathbf{V}_{D}\mathbf{U}_{L} & \mathbf{V}_{D}\mathbf{U}_{R}
\end{bmatrix}=\begin{bmatrix}I_{k} & 0\\
0 & I_{n-k}
\end{bmatrix}.\label{inverse}
\end{equation}

\end_inset

Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:unimodular_kernel_columnBasis"

\end_inset

 then gives: 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $I_{k}$
\end_inset

 is a column basis of 
\begin_inset Formula $\mathbf{V}_{U}$
\end_inset

 and a row basis of 
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset

, 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $I_{n-k}$
\end_inset

 is a column basis of 
\begin_inset Formula $\mathbf{V}_{D}$
\end_inset

 and a row basis of 
\begin_inset Formula $\mathbf{U}_{R}$
\end_inset

, 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{V}_{D}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset

 are kernel bases of each other, 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{V}_{U}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{R}$
\end_inset

 are kernel bases of each other.
 
\end_layout

\end_deeper
\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:matrixGCD"

\end_inset

 Let 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 with rank 
\begin_inset Formula $r$
\end_inset

.
 Suppose 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
begin{itemize}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
item[(i)]
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{N}\in\mathbb{K}\left[x\right]^{n\times(n-r)}$
\end_inset

 is a right kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\backslash
item[(ii)]
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula $\mathbf{G}\in\mathbb{K}\left[x\right]^{r\times n}$
\end_inset

 is a left kernel basis of 
\begin_inset Formula $\mathbf{N}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
end{itemize}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Then 
\begin_inset Formula $\mathbf{F}=\mathbf{T}\cdot\mathbf{G}$
\end_inset

 with 
\begin_inset Formula $\mathbf{T}\in\mathbb{K}\left[x\right]^{m\times r}$
\end_inset

 a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $\mathbf{U}=\begin{bmatrix}\mathbf{U}_{L},\mathbf{U}_{R}\end{bmatrix}$
\end_inset

 be a unimodular matrix with inverse 
\begin_inset Formula $\mathbf{V}=\begin{bmatrix}\mathbf{V}_{U}\\
\mathbf{V}_{D}
\end{bmatrix}$
\end_inset

 partitioned as in equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "inverse"

\end_inset

) and satisfying 
\begin_inset Formula $\mathbf{F}\cdot\mathbf{U}=\left[0,\mathbf{B}\right]$
\end_inset

 with 
\begin_inset Formula $\mathbf{B}\in\mathbb{K}\left[x\right]^{m\times r}$
\end_inset

 a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Then 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
textbf{ 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula $\mathbf{F}=\left[0,\mathbf{B}\right]\mathbf{U}^{-1}=\mathbf{B}\left[0,I\right]\mathbf{V}=\mathbf{B}\mathbf{V}_{D}.$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 Since 
\begin_inset Formula $\mathbf{V}_{D}$
\end_inset

 is a left kernel basis of
\series bold
 
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset


\series default
, any other left kernel basis 
\begin_inset Formula $\mathbf{G}$
\end_inset

 of 
\begin_inset Formula $\mathbf{U}_{L}$
\end_inset

 is unimodularly equivalent to 
\begin_inset Formula $\mathbf{V}_{D}$
\end_inset

, that is, 
\begin_inset Formula $\mathbf{V}_{D}=\mathbf{W}\cdot\mathbf{G}$
\end_inset

 for some unimodular matrix 
\begin_inset Formula $\mathbf{W}$
\end_inset

.
 Thus 
\begin_inset Formula $\mathbf{F}=\mathbf{B\cdot W}\cdot\mathbf{G}$
\end_inset

.
 Then 
\begin_inset Formula $\mathbf{T}=\mathbf{B\cdot W}$
\end_inset

 is a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 since it is unimodularly equivalent to the column basis 
\begin_inset Formula $\mathbf{B}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:matrixGCD"

\end_inset

 outlines a procedure for computing a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 with three main steps.
 The first step is to compute a right kernel basis 
\begin_inset Formula $\mathbf{N}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

, something which can be efficiently done using the kernel basis algorithm
 of 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

.
 The second step, computing a left kernel basis 
\begin_inset Formula $\mathbf{G}$
\end_inset

 for 
\begin_inset Formula $\mathbf{N}$
\end_inset

 and the third step, computing the column basis 
\begin_inset Formula $\mathbf{T}$
\end_inset

 from 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\mathbf{G}$
\end_inset

, will still require additional work for efficient computation.
 Note that, while Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:matrixGCD"

\end_inset

 does not require the bases computed to be minimal, working with minimal
 kernel bases keeps the degrees well controlled, an important consideration
 for efficient computation.
 
\end_layout

\begin_layout Example
Let 
\begin_inset Formula 
\[
\mathbf{F}=\left[\begin{array}{cccc}
x^{2} & x^{2} & x+x^{2} & 1+x^{2}\\
1+x+x^{2} & x^{2} & 1+x^{2} & 1+x^{2}
\end{array}\right]~
\]

\end_inset

be a matrix over 
\begin_inset Formula $\mathbb{Z}_{2}[x]$
\end_inset

.
 Then the matrix 
\begin_inset Formula 
\[
\mathbf{N}=\left[\begin{array}{cc}
x & 1\\
1 & x\\
x & 1\\
0 & x
\end{array}\right]
\]

\end_inset

is a right kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and the matrix 
\begin_inset Formula 
\[
\mathbf{G}=\left[\begin{array}{cccc}
1 & 0 & 1 & 0\\
\noalign{\medskip}x & {x}^{2} & 0 & 1+{x}^{2}
\end{array}\right]
\]

\end_inset

is a left kernel basis of 
\begin_inset Formula $\mathbf{N}$
\end_inset

.
 Finally the matrix 
\begin_inset Formula 
\[
\mathbf{T}=\left[\begin{array}{cc}
x+x^{2} & 1\\
1+x^{2} & 1
\end{array}\right]
\]

\end_inset

satisfies 
\begin_inset Formula $\mathbf{F}=\mathbf{T}\mathbf{G}$
\end_inset

, and is a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
qed
\end_layout

\end_inset

 
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:computeRightFactor"

\end_inset

Computing a Right Factor
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbf{N}$
\end_inset

 be an 
\begin_inset Formula $\left(\mathbf{F},\vec{s}\right)$
\end_inset

-kernel basis computed using the existing algorithm from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

.
 Consider now the problem of computing a left 
\begin_inset Formula $-\vec{s}$
\end_inset

-minimal kernel basis 
\begin_inset Formula $\mathbf{G}$
\end_inset

 for 
\begin_inset Formula $\mathbf{N}$
\end_inset

, or equivalently, a right 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\mathbf{G}^{T}$
\end_inset

.
 For this problem, the kernel basis algorithm of 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

 cannot be applied directly, since the input matrix 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

 has nonuniform row degrees and negative shift.
 Comparing to the earlier problem of computing a 
\begin_inset Formula $\vec{s}$
\end_inset

-minimal kernel basis 
\begin_inset Formula $\mathbf{N}$
\end_inset

 for 
\begin_inset Formula $\mathbf{F}$
\end_inset

, it is interesting to note that the original output 
\begin_inset Formula $\mathbf{N}$
\end_inset

 now becomes the new input matrix 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

, while the new output matrix 
\begin_inset Formula $\mathbf{G}$
\end_inset

 has size bounded by the size of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 In other words, the new input has degrees that match the original output,
 while the new output has degrees bounded by the original input.
 It is therefore reasonable to expect that the new problem can be computed
 efficiently.
 However, we need to find some way to work with the more complicated input
 degree structure.
 On the other hand, the simpler output degree structure makes it easier
 to apply order basis computation in order to compute a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis.
\end_layout

\begin_layout Subsection
Kernel Bases via Order Bases
\end_layout

\begin_layout Standard
In order to see how order basis computations can be applied here, let us
 first recall the following result (Lemma 3.3 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

) on a relationship between order bases and kernel bases.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:orderBasisContainsNullspaceBasis"

\end_inset

Let 
\begin_inset Formula $\mathbf{P}=\left[\mathbf{P}_{L},\mathbf{P}_{R}\right]$
\end_inset

 be any 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-order basis and 
\begin_inset Formula $\mathbf{N}=\left[\mathbf{N}_{L},\mathbf{N}_{R}\right]$
\end_inset

 be any 
\begin_inset Formula $\vec{s}$
\end_inset

-minimal kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

, where 
\begin_inset Formula $\mathbf{P}_{L}$
\end_inset

 and 
\begin_inset Formula $\mathbf{N}_{L}$
\end_inset

 contain all columns from 
\begin_inset Formula $\mathbf{P}$
\end_inset

 and 
\begin_inset Formula $\mathbf{N}$
\end_inset

, respectively, whose 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees are less than 
\begin_inset Formula $\sigma$
\end_inset

.
 Then 
\begin_inset Formula $\left[\mathbf{P}_{L},\mathbf{N}_{R}\right]$
\end_inset

 is a 
\begin_inset Formula $\vec{s}$
\end_inset

-minimal kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

, and 
\begin_inset Formula $\left[\mathbf{N}_{L},\mathbf{P}_{R}\right]$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-order basis.
 
\end_layout

\begin_layout Standard
It is not difficult to extend this result to the following lemma to accommodate
 our situation here.
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
For the remainder of this paper an integer vector of ones is denoted by
 
\begin_inset Formula $\vec{e}$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:orderbasisContainsKernelbasisGeneralized"

\end_inset

 Given a matrix 
\begin_inset Formula $\mathbf{A}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

 and some integer lists 
\begin_inset Formula $\vec{u}\in\mathbb{Z}^{n}$
\end_inset

 and 
\begin_inset Formula $\vec{v}\in\mathbb{Z}^{m}$
\end_inset

 such that 
\begin_inset Formula $\rdeg_{\vec{u}}\mathbf{A}\le\vec{v}$
\end_inset

, or equivalently, 
\begin_inset Formula $\cdeg_{-\vec{v}}\mathbf{A}\le-\vec{u}$
\end_inset

.
 Let 
\begin_inset Formula $\mathbf{P}$
\end_inset

 be a 
\begin_inset Formula $\left(\mathbf{A},\vec{v}+1,-\vec{u}\right)$
\end_inset

-order basis and 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 be any 
\begin_inset Formula $(\mathbf{A},-\vec{u})$
\end_inset

-kernel basis.
 Partition 
\begin_inset Formula $\mathbf{P}=\left[\mathbf{P}_{L},\mathbf{P}_{R}\right]$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}=\left[\mathbf{Q}_{L},\mathbf{Q}_{R}\right]$
\end_inset

 where 
\begin_inset Formula $\mathbf{P}_{L}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}_{L}$
\end_inset

 contain all the columns from 
\begin_inset Formula $\mathbf{P}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}$
\end_inset

, respectively, whose 
\begin_inset Formula $-\vec{u}$
\end_inset

-column degrees are no more than 
\begin_inset Formula $0$
\end_inset

.
 Then 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

[(i)]
\end_layout

\end_inset

 
\begin_inset Formula $\left[\mathbf{P}_{L},\mathbf{Q}_{R}\right]$
\end_inset

 is an 
\begin_inset Formula $(\mathbf{A},-\vec{u})$
\end_inset

-kernel basis, and 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

[(ii)]
\end_layout

\end_inset

 
\begin_inset Formula $\left[\mathbf{Q}_{L},\mathbf{P}_{R}\right]$
\end_inset

 is an 
\begin_inset Formula $\left(\mathbf{A},\vec{v}+1,-\vec{u}\right)$
\end_inset

-order basis.
 
\end_layout

\end_deeper
\begin_layout Proof
We can use the same proof from Lemma 3.3 in 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

.
 We know 
\begin_inset Formula $\cdeg_{-\vec{v}}\mathbf{A}\mathbf{P}_{L}\le\cdeg_{-\vec{u}}\mathbf{P}_{L}\le0$
\end_inset

, or equivalently, 
\begin_inset Formula $\rdeg\mathbf{A}\mathbf{P}_{L}\le\vec{v}$
\end_inset

.
 However it also has order greater than 
\begin_inset Formula $\vec{v}$
\end_inset

 and hence 
\begin_inset Formula $\mathbf{A}\mathbf{P}_{L}=0$
\end_inset

.
 Thus 
\begin_inset Formula $\mathbf{P}_{L}$
\end_inset

 is generated by the kernel basis 
\begin_inset Formula $\mathbf{Q}_{L}$
\end_inset

, that is, 
\begin_inset Formula $\mathbf{P}_{L}=\mathbf{Q}_{L}\mathbf{U}$
\end_inset

 for some polynomial matrix 
\begin_inset Formula $\mathbf{U}$
\end_inset

.
 On the other hand, 
\begin_inset Formula $\mathbf{Q}_{L}$
\end_inset

 certainly has order 
\begin_inset Formula $\left(\mathbf{A},\vec{v}+1\right)$
\end_inset

 and therefore is generated by 
\begin_inset Formula $\mathbf{P}_{L}$
\end_inset

, that is, 
\begin_inset Formula $\mathbf{Q}_{L}=\mathbf{P}_{L}\mathbf{V}$
\end_inset

 for some polynomial matrix 
\begin_inset Formula $\mathbf{V}$
\end_inset

.
 We now have 
\begin_inset Formula $\mathbf{P}_{L}=\mathbf{P}_{L}\mathbf{V}\mathbf{U}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}_{L}=\mathbf{Q}_{L}\mathbf{U}\mathbf{V}$
\end_inset

, implying both 
\begin_inset Formula $\mathbf{U}$
\end_inset

 and 
\begin_inset Formula $\mathbf{V}$
\end_inset

 are unimodular.
 The result then follows from the unimodular equivalence of 
\begin_inset Formula $\mathbf{P}_{L}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}_{L}$
\end_inset

 and the fact that they are 
\begin_inset Formula $-\vec{u}$
\end_inset

-column reduced.
 
\end_layout

\begin_layout Standard
With the help of Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:orderbasisContainsKernelbasisGeneralized"

\end_inset

 we can return to the problem of efficiently computing a 
\begin_inset Formula $(\mathbf{N}^{T},-\vec{s})$
\end_inset

-kernel basis.
 In fact, we just need to use a special case of Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:orderbasisContainsKernelbasisGeneralized"

\end_inset

, where all the elements of the kernel basis have shifted degrees bounded
 by 
\begin_inset Formula $0$
\end_inset

, thereby making the partial kernel basis be a complete kernel basis.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:kernelBasisInOrderBasis"

\end_inset

 Let 
\begin_inset Formula $\mathbf{N}$
\end_inset

 be a 
\begin_inset Formula $(\mathbf{F},\vec{s})$
\end_inset

-kernel basis with 
\begin_inset Formula $\cdeg_{\vec{s}}~\mathbf{N}=\vec{b}$
\end_inset

.
 Then any 
\begin_inset Formula $(\mathbf{N}^{T},-\vec{s})$
\end_inset

-kernel basis 
\begin_inset Formula $\mathbf{G}^{T}$
\end_inset

 satisfies 
\begin_inset Formula $\cdeg_{-\vec{s}}\mathbf{G}^{T}\le0$
\end_inset

.
 Let 
\begin_inset Formula $\mathbf{P}=\left[\mathbf{P}_{L},\mathbf{P}_{R}\right]$
\end_inset

 be a 
\begin_inset Formula $\left(\mathbf{N}^{T},\vec{b}+1,-\vec{s}\right)$
\end_inset

-order basis, where 
\begin_inset Formula $\mathbf{P}_{L}$
\end_inset

 consists of all columns 
\begin_inset Formula $\mathbf{p}$
\end_inset

 satisfying 
\begin_inset Formula $\cdeg_{-\vec{s}}~\mathbf{p}\le0$
\end_inset

.
 Then 
\begin_inset Formula $\mathbf{P}_{L}$
\end_inset

 is a 
\begin_inset Formula $(\mathbf{N}^{T},-\vec{s})$
\end_inset

-kernel basis.
 
\end_layout

\begin_layout Proof
The column dimension of any 
\begin_inset Formula $(\mathbf{N}^{T},-\vec{s})$
\end_inset

-kernel basis 
\begin_inset Formula $\mathbf{G}^{T}$
\end_inset

 equals the rank 
\begin_inset Formula $r$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Since both 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\mathbf{G}$
\end_inset

 are in the left kernel of 
\begin_inset Formula $\mathbf{N}$
\end_inset

, we know 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is generated by 
\begin_inset Formula $\mathbf{G}$
\end_inset

, and the 
\begin_inset Formula $-\vec{s}$
\end_inset

-minimality of 
\begin_inset Formula $\mathbf{G}$
\end_inset

 ensures that the 
\begin_inset Formula $-\vec{s}$
\end_inset

-row degrees of 
\begin_inset Formula $\mathbf{G}$
\end_inset

 are bounded by the corresponding 
\begin_inset Formula $r$
\end_inset

 largest 
\begin_inset Formula $-\vec{s}$
\end_inset

-row degrees of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 These are in turn bounded by 
\begin_inset Formula $0$
\end_inset

 since 
\begin_inset Formula $\cdeg\mathbf{F}\le\vec{s}$
\end_inset

.
 Therefore, any 
\begin_inset Formula $(\mathbf{N}^{T},-\vec{s})$
\end_inset

-kernel basis 
\begin_inset Formula $\mathbf{G}^{T}$
\end_inset

 satisfies 
\begin_inset Formula $\cdeg_{-\vec{s}}\mathbf{G}^{T}\le0$
\end_inset

.
 The result follows from Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:orderbasisContainsKernelbasisGeneralized"

\end_inset

.
 
\end_layout

\begin_layout Standard
While 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:kernelBasisInOrderBasis"

\end_inset

 shows that a complete 
\begin_inset Formula $(\mathbf{N}^{T},-\vec{s})$
\end_inset

-kernel basis can be computed by computing a 
\begin_inset Formula $\left(\mathbf{N}^{T},\vec{b}+1,-\vec{s}\right)$
\end_inset

-order basis, in fact we do not compute such a order basis, as the computational
 efficiency can be improved by using Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:continueComputingKernelBasisByRows"

\end_inset

 to compute a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis by rows.
 More specifically, we can partition 
\begin_inset Formula $\mathbf{N}$
\end_inset

 into 
\begin_inset Formula $\left[\mathbf{N}_{1},\mathbf{N}_{2}\right]$
\end_inset

 with 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees 
\begin_inset Formula $\vec{b}_{1}$
\end_inset

, 
\begin_inset Formula $\vec{b}_{2}$
\end_inset

 respectively, compute a 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},-\vec{s}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\mathbf{Q}_{1}$
\end_inset

 with 
\begin_inset Formula $-\vec{s}$
\end_inset

-column degrees 
\begin_inset Formula $-\vec{s}_{2}$
\end_inset

, and then compute a 
\begin_inset Formula $\left(\mathbf{N}_{2}^{T}\mathbf{Q}_{1},-\vec{s}_{2}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\mathbf{Q}_{2}$
\end_inset

, then 
\begin_inset Formula $\mathbf{Q}_{1}\mathbf{Q}_{2}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis.
 In order to compute the kernel bases 
\begin_inset Formula $\mathbf{Q}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}_{2}$
\end_inset

, we still use order basis computations but work with subsets of rows rather
 than the whole matrix 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

.
 We now need to make sure that the order bases computed from subsets of
 rows contain these kernel bases.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:kernelBasisOfSubsetOfRowsContainedInOrderBasis"

\end_inset

 Let 
\begin_inset Formula $\mathbf{N}$
\end_inset

 be partitioned as 
\begin_inset Formula $\left[\mathbf{N}_{1},\mathbf{N}_{2}\right]$
\end_inset

, with 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees 
\begin_inset Formula $\vec{b}_{1}$
\end_inset

, 
\begin_inset Formula $\vec{b}_{2}$
\end_inset

, respectively.
 Then we have the following: 
\end_layout

\begin_deeper
\begin_layout Enumerate
A 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},\vec{b}_{1}+1,-\vec{s}\right)$
\end_inset

-order basis contains a 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},-\vec{s}\right)$
\end_inset

-kernel basis whose 
\begin_inset Formula $-\vec{s}$
\end_inset

-column degrees are bounded by 
\begin_inset Formula $0$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
If 
\begin_inset Formula $\mathbf{Q}_{1}$
\end_inset

 is this 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},-\vec{s}\right)$
\end_inset

-kernel basis from above and 
\begin_inset Formula $-\vec{s}_{2}=\cdeg_{-\vec{s}}\mathbf{Q}_{1}$
\end_inset

, then a 
\begin_inset Formula $\left(\mathbf{N}_{2}^{T}\mathbf{Q}_{1},\vec{b}_{2}+1,-\vec{s}_{2}\right)$
\end_inset

-basis contains a 
\begin_inset Formula $\left(\mathbf{N}_{2}^{T}\mathbf{Q}_{1},-\vec{s}_{2}\right)$
\end_inset

-kernel basis, 
\begin_inset Formula $\mathbf{Q}_{2}$
\end_inset

, whose 
\begin_inset Formula $-\vec{s}$
\end_inset

-column degrees are bounded by 
\begin_inset Formula $0$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
The product 
\begin_inset Formula $\mathbf{Q}_{1}\mathbf{Q}_{2}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis.
 
\end_layout

\end_deeper
\begin_layout Proof
To see that a 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},\vec{b}_{1}+1,-\vec{s}\right)$
\end_inset

-basis contains a 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},-\vec{s}\right)$
\end_inset

-kernel basis whose 
\begin_inset Formula $-\vec{s}$
\end_inset

-column degrees are bounded by 0, we just need to show that 
\begin_inset Formula $\cdeg_{-\vec{s}}\mathbf{\bar{Q}}_{1}\le0$
\end_inset

 for any 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},-\vec{s}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\mathbf{\bar{Q}}_{1}$
\end_inset

 and then apply 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:orderbasisContainsKernelbasisGeneralized"

\end_inset

.
 Note that there exists a polynomial matrix 
\begin_inset Formula $\bar{\mathbf{Q}}_{2}$
\end_inset

 such that 
\begin_inset Formula $\mathbf{\bar{Q}}_{1}\mathbf{\bar{Q}}_{2}=\bar{\mathbf{G}}$
\end_inset

 for any 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\bar{\mathbf{G}}$
\end_inset

, as 
\begin_inset Formula $\bar{\mathbf{G}}$
\end_inset

 satisfies 
\begin_inset Formula $\mathbf{N}_{1}^{T}\bar{\mathbf{G}}=0$
\end_inset

 and is therefore generated by the 
\begin_inset Formula $\left(\mathbf{N}_{1}^{T},-\vec{s}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\bar{\mathbf{Q}}_{1}$
\end_inset

.
 If 
\begin_inset Formula $\cdeg_{-\vec{s}}\mathbf{\bar{Q}}_{1}\nleq0$
\end_inset

, then 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:predictableDegree"

\end_inset

 forces 
\begin_inset Formula $\cdeg_{-\vec{s}}\left(\bar{\mathbf{Q}}_{1}\bar{\mathbf{Q}}_{2}\right)=\cdeg_{-\vec{s}}\bar{\mathbf{G}}\nleq0,$
\end_inset

a contradiction since we know from 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:kernelBasisInOrderBasis"

\end_inset

 that 
\begin_inset Formula $\cdeg_{-\vec{s}}\bar{\mathbf{G}}\le0$
\end_inset

.
\end_layout

\begin_layout Proof
As before, to see that a 
\begin_inset Formula $\left(\mathbf{N}_{2}^{T}\mathbf{Q}_{1},\vec{b}_{2}+1,-\vec{s}_{2}\right)$
\end_inset

-basis contains a 
\begin_inset Formula $\left(\mathbf{N}_{2}^{T}\mathbf{Q}_{1},-\vec{s}_{2}\right)$
\end_inset

-kernel basis whose 
\begin_inset Formula $-\vec{s}$
\end_inset

-column degrees are no more than 0, we can just show 
\begin_inset Formula $\cdeg_{-\vec{s}_{2}}\hat{\mathbf{Q}}_{2}\le0$
\end_inset

 for any 
\begin_inset Formula $\left(\mathbf{N}_{2}^{T}\mathbf{Q}_{1},-\vec{s}_{2}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\hat{\mathbf{Q}}_{2}$
\end_inset

 and then apply 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:orderbasisContainsKernelbasisGeneralized"

\end_inset

.
 Since 
\begin_inset Formula $\cdeg_{\vec{s}}\mathbf{N}_{2}=\vec{b}_{2}$
\end_inset

, we have 
\begin_inset Formula $\rdeg_{-\vec{b}_{2}}\mathbf{N}_{2}\le-\vec{s}$
\end_inset

 or equivalently, 
\begin_inset Formula $\cdeg_{-\vec{b}_{2}}\mathbf{N}_{2}^{T}\le-\vec{s}.$
\end_inset

 Then combining this with 
\begin_inset Formula $\cdeg_{-\vec{s}}\mathbf{Q}_{1}=-\vec{s}_{2}$
\end_inset

 we get 
\begin_inset Formula $\cdeg_{-\vec{b}_{2}}\mathbf{N}_{2}^{T}\mathbf{Q}_{1}\le-\vec{s}_{2}$
\end_inset

 using 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:predictableDegree"

\end_inset

.
 Let 
\begin_inset Formula $\hat{\mathbf{G}}=\mathbf{Q}_{1}\hat{\mathbf{Q}}_{2}$
\end_inset

, which is a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis by 
\begin_inset CommandInset ref
LatexCommand formatted
reference "thm:continueComputingKernelBasisByRows"

\end_inset

.
 Note that 
\begin_inset Formula $\cdeg_{-\vec{s}_{2}}\hat{\mathbf{Q}}_{2}=\cdeg_{-\vec{s}}\mathbf{Q}_{1}\hat{\mathbf{Q}}_{2}=\cdeg_{-\vec{s}}\hat{\mathbf{G}}\le0.$
\end_inset

 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:kernelBasisViaOrderBasisByRows"

\end_inset

Efficient Computation of Kernel Bases
\end_layout

\begin_layout Standard
Now that we can correctly compute a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis by rows with the help of order basis computation using 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:kernelBasisOfSubsetOfRowsContainedInOrderBasis"

\end_inset

, we need to look at how to do this efficiently.
 One major difficulty is that the order 
\begin_inset Formula $\vec{b}+1$
\end_inset

, or equivalently, the 
\begin_inset Formula $\vec{s}$
\end_inset

-row degrees of 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

 may be unbalanced and can have degree as large as 
\begin_inset Formula $\sum\vec{s}$
\end_inset

.
 Note that the existing kernel basis algorithm from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

 handles input matrices with unbalanced column degrees, but not unbalanced
 row degrees.
 For example, in the simpler special case of 
\begin_inset Formula $\vec{s}=\left[s,\dots,s\right]$
\end_inset

 having uniformly equal entries, the sum of the row degrees is 
\begin_inset Formula $O(ns)$
\end_inset

, but the sum of column degrees can be 
\begin_inset Formula $\Theta\left(n^{2}s\right)$
\end_inset

, which puts an extra factor 
\begin_inset Formula $n$
\end_inset

 to the cost if the algorithm from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

 is used.
 To overcome this problem with unbalanced 
\begin_inset Formula $\vec{s}$
\end_inset

-row degrees, we separate the rows of 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

 into blocks according to their 
\begin_inset Formula $\vec{s}$
\end_inset

-row degrees, and then work with these blocks one by one successively using
 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:kernelBasisOfSubsetOfRowsContainedInOrderBasis"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $\mnbr(\mathbf{M},\vec{s},\xi)$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
(Kernel basis computation with reversed degree structure)
\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:minimalKernelBasisReverse"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace smallskip
\end_inset


\begin_inset Flex ALGORITHMIC
status open

\begin_layout Plain Layout
\begin_inset Flex INPUT
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{M}\in\mathbb{K}\left[x\right]^{k\times n}$
\end_inset

 and 
\begin_inset Formula $\vec{s}\in\mathbb{Z}_{\ge0}^{n}$
\end_inset

 such that 
\begin_inset Formula $\sum\rdeg_{\vec{s}}\mathbf{M}\le\xi$
\end_inset

, 
\begin_inset Formula $\sum\vec{s}\le\xi$
\end_inset

, and any 
\begin_inset Formula $\left(\mathbf{M},-\vec{s}\right)$
\end_inset

-kernel basis having row degrees bounded by 
\begin_inset Formula $\vec{s}$
\end_inset

 (equivalently, having 
\begin_inset Formula $-\vec{s}$
\end_inset

-column degrees bounded by 0).
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
\begin_inset VSpace bigskip
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex OUTPUT
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{G}\in\mathbb{K}\left[x\right]^{n\times*}$
\end_inset

, a 
\begin_inset Formula $\left(\mathbf{M},-\vec{s}\right)$
\end_inset

-kernel basis.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace smallskip
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\left[\mathbf{M}_{1}^{T},\mathbf{M}_{2}^{T},\cdots,\mathbf{M}_{\left\lceil \log k\right\rceil -1}^{T},\mathbf{M}_{\left\lceil \log k\right\rceil }^{T}\right]:=\mathbf{M}^{T}$
\end_inset


\series default
, with 
\begin_inset Formula $\mathbf{M}_{\left\lceil \log k\right\rceil },\mathbf{M}_{\left\lceil \log k\right\rceil -1},\cdots,\mathbf{M}_{2},\mathbf{M}_{1}$
\end_inset

 having 
\begin_inset Formula $\vec{s}$
\end_inset

-row degrees in the range 
\begin_inset Formula $\left[0,\frac{2\xi}{k}\right],(\frac{2\xi}{k},\frac{4\xi}{k}],...,(\frac{\xi}{4},\frac{\xi}{2}],(\frac{\xi}{2},\xi].$
\end_inset


\series bold
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex FOR
status open

\begin_layout Plain Layout
\begin_inset Formula $i$
\end_inset

 
\series bold
from 
\begin_inset Formula $1$
\end_inset

 to 
\begin_inset Formula $\left\lceil \log k\right\rceil $
\end_inset

 
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Flex FORBODY
status open

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\sigma_{i}:=\left\lceil \frac{\xi}{2^{i-1}}\right\rceil +1$
\end_inset

;
\begin_inset Formula $\vec{\sigma}_{i}:=\left[\sigma_{i},\dots,\sigma_{i}\right]$
\end_inset

, number of entries matching the row dimension of 
\begin_inset Formula $\mathbf{M}_{i};$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\vec{\sigma}:=\left[\vec{\sigma}_{1},\vec{\sigma}_{2},\dots,\vec{\sigma}_{\left\lceil \log k\right\rceil }\right]$
\end_inset

;
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\hat{\mathbf{N}}:=x^{\vec{\sigma}-\vec{b}-1}\mathbf{M};$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{G}_{0}:=I_{n}$
\end_inset

; 
\begin_inset Formula $\tilde{\mathbf{G}}_{0}:=I_{n};$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex FOR
status open

\begin_layout Plain Layout
\begin_inset Formula $i$
\end_inset

 
\series bold
from 
\begin_inset Formula $1$
\end_inset

 to 
\begin_inset Formula $\left\lceil \log k\right\rceil $
\end_inset

 
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Flex FORBODY
status open

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\vec{s}_{i}:=-\cdeg_{-\vec{s}}\mathbf{G}_{i-1};$
\end_inset

 (note 
\begin_inset Formula $\vec{s}_{1}=\vec{s}$
\end_inset

)
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{i}:=\umab\left(\hat{\mathbf{N}}_{i}\tilde{\mathbf{G}}_{i-1},\sigma_{i},-\vec{s}_{i}\right)$
\end_inset

; 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\left[\mathbf{G}_{i},\mathbf{Q}_{i}\right]:=\mathbf{P}_{i}$
\end_inset

, where 
\begin_inset Formula $\mathbf{G}_{i}$
\end_inset

 is a 
\begin_inset Formula $\left(\hat{\mathbf{M}}_{i},-\vec{s}_{i}\right)$
\end_inset

-kernel basis;
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\tilde{\mathbf{G}_{i}}:=\tilde{\mathbf{G}}_{i-1}\cdot\mathbf{G}_{i};$
\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{R}:=\left[\mathbf{R},\tilde{\mathbf{N}}_{i-1}\mathbf{Q}_{i}\right]$
\end_inset

;
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{R}^{r}:=\revCol\left(\mathbf{R},-\vec{s},\cdeg_{-\vec{s}}\mathbf{R}\right);$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
RETURN
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{\mathbf{G}_{i}}$
\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $k$
\end_inset

 be the column dimension of 
\begin_inset Formula $\mathbf{N}$
\end_inset

 and 
\begin_inset Formula $\xi$
\end_inset

 be an upper bound of 
\begin_inset Formula $\sum\vec{s}$
\end_inset

.
 Since 
\begin_inset Formula $\sum\cdeg_{\vec{s}}\mathbf{N}=\sum\vec{b}\le\sum\vec{s}\le\xi$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand formatted
reference "thm:boundOfSumOfShiftedDegreesOfKernelBasis"

\end_inset

, at most 
\begin_inset Formula $\frac{k}{c}$
\end_inset

 columns of 
\begin_inset Formula $\mathbf{N}$
\end_inset

 have 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees greater than or equal to 
\begin_inset Formula $\frac{c~\xi}{k}$
\end_inset

 for any 
\begin_inset Formula $c\ge1$
\end_inset

.
 Without loss of generality we can assume that the rows of 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

 are arranged in decreasing 
\begin_inset Formula $\vec{s}$
\end_inset

-row degrees.
 We divide 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

 into 
\begin_inset Formula $\left\lceil \log k\right\rceil $
\end_inset

 row blocks according to the 
\begin_inset Formula $\vec{s}$
\end_inset

-row degrees of its rows, or equivalently, divide 
\begin_inset Formula $\mathbf{N}$
\end_inset

 into blocks of columns according to the 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees.
 Let 
\begin_inset Formula $\mathbf{N}=\left[\mathbf{N}_{1},\mathbf{N}_{2},\cdots,\mathbf{N}_{\left\lceil \log k\right\rceil -1},\mathbf{N}_{\left\lceil \log k\right\rceil }\right]$
\end_inset

 with 
\begin_inset Formula $\mathbf{N}_{\left\lceil \log k\right\rceil },\mathbf{N}_{\left\lceil \log k\right\rceil -1},\dots,\mathbf{N}_{2},\mathbf{N}_{1}$
\end_inset

 having 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees in the range 
\begin_inset Formula $\left[0,2\xi/k\right]$
\end_inset

, 
\begin_inset Formula $(2\xi/k,4\xi/k],$
\end_inset

 
\begin_inset Formula $(4\xi/k,8\xi/k],\ ...,$
\end_inset

 
\begin_inset Formula $(\xi/4,\xi/2],$
\end_inset

 
\begin_inset Formula $(\xi/2,\xi]$
\end_inset

, respectively.
 Let 
\begin_inset Formula $\sigma_{i}=\left\lceil \xi/2^{i-1}\right\rceil +1$
\end_inset

 and 
\begin_inset Formula $\vec{\sigma}_{i}=\left[\sigma_{i},\dots,\sigma_{i}\right]$
\end_inset

 with the same dimension as the row dimension of 
\begin_inset Formula $\mathbf{N}_{i}$
\end_inset

 and 
\begin_inset Formula $\vec{\sigma}=\left[\vec{\sigma}_{\left\lceil \log k\right\rceil },\vec{\sigma}_{\left\lceil \log k\right\rceil -1},\dots,\vec{\sigma}_{1}\right]$
\end_inset

 be the orders in the order basis computation.
\end_layout

\begin_layout Standard
To further simplify our task, we also make the order of our problem in each
 block uniform.
 Rather than of using 
\begin_inset Formula $\mathbf{N}^{T}$
\end_inset

 as the input matrix, we instead use 
\begin_inset Formula 
\begin{eqnarray*}
\hat{\mathbf{N}} & =\begin{bmatrix}\hat{\mathbf{N}}_{1}\\
\vdots\\
\hat{\mathbf{N}}_{\left\lceil \log k\right\rceil }
\end{bmatrix}= & x^{\vec{\sigma}-\vec{b}-1}\begin{bmatrix}\mathbf{N}_{1}^{T}\\
\vdots\\
\mathbf{N}_{\left\lceil \log k\right\rceil }^{T}
\end{bmatrix}=x^{\vec{\sigma}-\vec{b}-1}\mathbf{N}^{T}
\end{eqnarray*}

\end_inset

so that a 
\begin_inset Formula $\left(\hat{\mathbf{N}},\vec{\sigma},-\vec{s}\right)$
\end_inset

-order basis is a 
\begin_inset Formula $\left(\mathbf{N}^{T},\vec{b}+1,-\vec{s}\right)$
\end_inset

-order basis.
\end_layout

\begin_layout Standard
In order to compute a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis we determine a series of kernel bases via a series of order
 basis computations as follows: 
\end_layout

\begin_layout Enumerate
Let 
\begin_inset Formula $\vec{s}_{1}=\vec{s}$
\end_inset

.
 Compute an 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{1},\vec{\sigma}_{1},-\vec{s}_{1}\right)$
\end_inset

-order basis 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

 using Algorithm 2 from 
\begin_inset CommandInset citation
LatexCommand cite
key "ZL2012"

\end_inset

 for order basis computation with unbalanced shift.
 Note that here the order 
\begin_inset Formula $\vec{\sigma}_{1}=\left[\sigma_{1},\dots,\sigma_{1}\right]$
\end_inset

 is uniform, an 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{1},\vec{\sigma}_{1},-\vec{s}_{1}\right)$
\end_inset

 order basis is also 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{1},\sigma_{1},-\vec{s}_{1}\right)$
\end_inset

-order basis.
 Partition 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

 as 
\begin_inset Formula $\mathbf{P}_{1}=\left[\mathbf{G}_{1},\mathbf{Q}_{1}\right]$
\end_inset

, where 
\begin_inset Formula $\mathbf{G}_{1}$
\end_inset

 is a 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{1},-\vec{s}_{1}\right)$
\end_inset

-kernel basis by 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:kernelBasisOfSubsetOfRowsContainedInOrderBasis"

\end_inset

.
 Set 
\begin_inset Formula $\tilde{\mathbf{G}}_{1}=\mathbf{G}_{1}$
\end_inset

 and 
\begin_inset Formula $\vec{s}_{2}=-\cdeg_{-\vec{s}}\mathbf{G}_{1}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Compute an 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{2}\tilde{\mathbf{G}}_{1},\sigma_{2},-\vec{s}_{2}\right)$
\end_inset

-order basis 
\begin_inset Formula $\mathbf{P}_{2}$
\end_inset

 and partition 
\begin_inset Formula $\mathbf{P}_{2}=\left[\mathbf{G}_{2},\mathbf{Q}_{2}\right]$
\end_inset

 with 
\begin_inset Formula $\mathbf{G}_{2}$
\end_inset

 a 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{2},-\vec{s}_{2}\right)$
\end_inset

-kernel basis.
 Set 
\begin_inset Formula $\vec{s}_{3}=-\cdeg_{-\vec{s}_{2}}\mathbf{G}_{2}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mathbf{G}}_{2}=\tilde{\mathbf{G}}_{1}\mathbf{G}_{2}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Continuing this process, at each step 
\begin_inset Formula $i$
\end_inset

 we compute a 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{i}\tilde{\mathbf{G}}_{i-1},\sigma_{i},-\vec{s}_{i}\right)$
\end_inset

-order basis 
\begin_inset Formula $\mathbf{P}_{i}$
\end_inset

 and then partition 
\begin_inset Formula $\mathbf{P}_{i}=\left[\mathbf{G}_{i},\mathbf{Q}_{i}\right]$
\end_inset

 with 
\begin_inset Formula $\mathbf{G}_{i}$
\end_inset

 a 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{i}\tilde{\mathbf{G}}_{i-1},-\vec{s}_{i}\right)$
\end_inset

-kernel basis.
 Let 
\begin_inset Formula $\tilde{\mathbf{G}}_{i}=\prod_{j=1}^{i}\mathbf{G}_{i}=\tilde{\mathbf{G}}_{i-1}\mathbf{G}_{i}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Return 
\begin_inset Formula $\tilde{\mathbf{G}}_{\left\lceil \log k\right\rceil }$
\end_inset

, a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis.
 
\end_layout

\begin_layout Standard
This process of computing a 
\begin_inset Formula $\left(\mathbf{N}^{T},-\vec{s}\right)$
\end_inset

-kernel basis is formally given in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:minimalKernelBasisReverse"

\end_inset

.
\end_layout

\begin_layout Subsection
Cost of Kernel Basis Computation
\end_layout

\begin_layout Standard
The cost of Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:minimalKernelBasisReverse"

\end_inset

 is dominated by the order basis computations and the multiplications 
\begin_inset Formula $\hat{\mathbf{N}}_{i}\tilde{\mathbf{G}}_{i-1}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mathbf{G}}_{i-1}\mathbf{G}_{i}$
\end_inset

.
 Let 
\begin_inset Formula $s=\xi/n$
\end_inset

.
 
\end_layout

\begin_layout Lemma
An 
\begin_inset Formula $\left(\hat{\mathbf{N}}_{i}\tilde{\mathbf{G}}_{i-1},\sigma_{i},-\vec{s}_{i}\right)$
\end_inset

-order basis can be computed with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

.
 
\end_layout

\begin_layout Proof
Note that 
\begin_inset Formula $\mathbf{N}_{i}$
\end_inset

 has less than 
\begin_inset Formula $2^{i}$
\end_inset

 columns.
 Otherwise, since 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\cdeg_{\vec{s}}\mathbf{N}_{i}>\xi/2^{i}$
\end_inset

, we have
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 
\begin_inset Formula $\sum\cdeg_{\vec{s}}\mathbf{N}_{i}>2^{i}\xi/2^{i}=\xi,$
\end_inset

 contradicting with 
\begin_inset Formula $\sum\cdeg_{\vec{s}}\mathbf{N}=\sum\vec{b}\le\sum\vec{s}\le\xi.$
\end_inset

 It follows that 
\begin_inset Formula $\hat{\mathbf{N}}_{i}$
\end_inset

, and therefore 
\begin_inset Formula $\hat{\mathbf{N}}_{i}\tilde{\mathbf{G}}_{i-1}$
\end_inset

, also have less than 
\begin_inset Formula $2^{i}$
\end_inset

 rows.
 We also have 
\begin_inset Formula $\sigma_{i}=\left\lceil \xi/2^{i-1}\right\rceil +1\in\Theta\left(\xi/2^{i}\right)$
\end_inset

.
 Therefore, Algorithm 2 from 
\begin_inset CommandInset citation
LatexCommand cite
key "ZL2012"

\end_inset

 for order basis computation with unbalanced shift can be used with a cost
 of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

.
 
\end_layout

\begin_layout Lemma
The multiplications 
\begin_inset Formula $\hat{\mathbf{N}}_{i}\tilde{\mathbf{G}}_{i-1}$
\end_inset

 can be done with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

.
\end_layout

\begin_layout Proof
The dimension of 
\begin_inset Formula $\hat{\mathbf{N}}_{i}$
\end_inset

 is bounded by 
\begin_inset Formula $2^{i}\times n$
\end_inset

 and 
\begin_inset Formula $\sum\rdeg_{\vec{s}}\hat{\mathbf{N}}_{i}\le2^{i}\cdot\xi/2^{i-1}\in O\left(\xi\right)$
\end_inset

.
 We also have 
\begin_inset Formula $\cdeg_{-\vec{s}}\tilde{\mathbf{G}}_{i-1}\le0$
\end_inset

, or equivalently, 
\begin_inset Formula $\rdeg\tilde{\mathbf{G}}_{i-1}\le\vec{s}$
\end_inset

.
 We can now use Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:multiplyUnbalancedMatrices"

\end_inset

 to multiply 
\begin_inset Formula $\tilde{\mathbf{G}}_{i-1}^{T}$
\end_inset

 and 
\begin_inset Formula $\hat{\mathbf{N}}_{i}^{T}$
\end_inset

 with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

.
\end_layout

\begin_layout Lemma
The multiplication 
\begin_inset Formula $\tilde{\mathbf{G}}_{i-1}\mathbf{G}_{i}$
\end_inset

 can be done with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

.
 
\end_layout

\begin_layout Proof
We know 
\begin_inset Formula $\cdeg_{-\vec{s}}\tilde{\mathbf{G}}_{i-1}=-\vec{s}_{i}$
\end_inset

, and 
\begin_inset Formula $\cdeg_{-\vec{s}_{i}}\mathbf{G}_{i}=-\vec{s}_{i+1}\le0.$
\end_inset

 In other words, 
\begin_inset Formula $\rdeg\mathbf{G}_{i}\le\vec{s}_{i}$
\end_inset

, and 
\begin_inset Formula $\rdeg_{\vec{s}_{i}}\tilde{\mathbf{G}}_{i-1}\le\vec{s}$
\end_inset

, hence we can again use Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:multiplyUnbalancedMatrices"

\end_inset

 to multiply 
\begin_inset Formula $\mathbf{G}_{i}^{T}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mathbf{G}}_{i-1}^{T}$
\end_inset

 with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:costKernelBasisReverse"

\end_inset

Given an input matrix 
\begin_inset Formula $\mathbf{M}\in\mathbb{K}\left[x\right]^{k\times n}$
\end_inset

, a shift 
\begin_inset Formula $\vec{s}\in\mathbb{Z}^{n}$
\end_inset

, and an upper bound 
\begin_inset Formula $\xi\in\mathbb{Z}$
\end_inset

 such that 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

[(i)]
\end_layout

\end_inset

 
\begin_inset Formula $\sum\rdeg_{\vec{s}}\mathbf{M}\le\xi$
\end_inset

, 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

[(ii)]
\end_layout

\end_inset

 
\begin_inset Formula $\sum\vec{s}\le\xi$
\end_inset

, 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

[(iii)]
\end_layout

\end_inset

 any 
\begin_inset Formula $\left(\mathbf{M},-\vec{s}\right)$
\end_inset

-kernel basis having row degrees bounded by 
\begin_inset Formula $\vec{s}$
\end_inset

, or equivalently, 
\begin_inset Formula $-\vec{s}$
\end_inset

-column degrees bounded by 0.
 
\end_layout

\end_deeper
\begin_layout Lemma
Then 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:minimalKernelBasisReverse"

\end_inset

 costs 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

 field operations to compute a 
\begin_inset Formula $\left(\mathbf{M},-\vec{s}\right)$
\end_inset

-kernel basis.
 
\end_layout

\begin_layout Standard
Note that while the upper bound 
\begin_inset Formula $\xi$
\end_inset

 can be simply replaced by 
\begin_inset Formula $\sum\vec{s}$
\end_inset

 in Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:costKernelBasisReverse"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:minimalKernelBasisReverse"

\end_inset

 for computing a right factor in this section, keeping it separate makes
 the algorithm more general and allows it to be reused in the next section.
 
\end_layout

\begin_layout Standard
It may also be informative to note again the correspondence between 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:costKernelBasisReverse"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand formatted
reference "thm:costGeneral"

\end_inset

, on the reversal of the degree structures of the input matrices and the
 output kernel bases.
\end_layout

\begin_layout Theorem
A right factor 
\begin_inset Formula $\mathbf{G}$
\end_inset

 satisfying 
\begin_inset Formula $\mathbf{F}=\mathbf{TG}$
\end_inset

 for a column basis 
\begin_inset Formula $\mathbf{T}$
\end_inset

 can be computed with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

.
 
\end_layout

\begin_layout Section
Computing a Column Basis
\end_layout

\begin_layout Standard
Once a right factor 
\begin_inset Formula $\mathbf{G}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 has been computed, we are in a position to determine a column basis 
\begin_inset Formula $\mathbf{T}$
\end_inset

 using the equation 
\begin_inset Formula $\mathbf{F}=\mathbf{T}\mathbf{G}$
\end_inset

.
 In order to do so efficiently, however, the degree of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 cannot be too large.
 We see that this is the case from the following lemma.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:colBasisdegreeBoundByRdegOfRightFactor"

\end_inset

 Let 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\mathbf{G}$
\end_inset

 be as before and 
\begin_inset Formula $\vec{t}=-\rdeg_{-\vec{s}}\mathbf{G}$
\end_inset

.
 Then 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

[(i)]
\end_layout

\end_inset

 the column degrees of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 are bounded by the corresponding entries of 
\begin_inset Formula $\vec{t}$
\end_inset

; 
\end_layout

\begin_layout Itemize
\begin_inset ERT
status open

\begin_layout Plain Layout

[(ii)]
\end_layout

\end_inset

 if 
\begin_inset Formula $\vec{t}$
\end_inset

 has 
\begin_inset Formula $r$
\end_inset

 entries and 
\begin_inset Formula $\vec{s}^{~\prime}$
\end_inset

 is the list of the 
\begin_inset Formula $r$
\end_inset

 largest entries of 
\begin_inset Formula $\vec{s}$
\end_inset

, then 
\begin_inset Formula $\vec{t}\le\vec{s}^{~\prime}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Proof
Since 
\begin_inset Formula $\mathbf{G}$
\end_inset

 is 
\begin_inset Formula $-\vec{s}$
\end_inset

-row reduced, and 
\begin_inset Formula $\rdeg_{-\vec{s}}\mathbf{F}\le0$
\end_inset

, by Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:predictableDegree"

\end_inset

 
\begin_inset Formula $\rdeg_{-\vec{t}}\mathbf{T}\le0$
\end_inset

, or equivalently, 
\begin_inset Formula $\mathbf{T}$
\end_inset

 has column degrees bounded by 
\begin_inset Formula $\vec{t}$
\end_inset

.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $\mathbf{G}^{\prime}$
\end_inset

 be the 
\begin_inset Formula $-\vec{s}$
\end_inset

-row Popov form of 
\begin_inset Formula $\mathbf{G}$
\end_inset

 and the square matrix 
\begin_inset Formula $\mathbf{G}^{\prime\prime}$
\end_inset

 consist of only the columns of 
\begin_inset Formula $\mathbf{G}^{\prime}$
\end_inset

 that contains pivot entries, and has the rows permuted so the pivots are
 in the diagonal.
 Let 
\begin_inset Formula $\vec{s}^{~\prime\prime}$
\end_inset

 be the list of the entries in 
\begin_inset Formula $\vec{s}$
\end_inset

 that correspond to the columns of 
\begin_inset Formula $\mathbf{G}^{\prime\prime}$
\end_inset

 in 
\begin_inset Formula $\mathbf{G}^{\prime}$
\end_inset

.
 Note that 
\begin_inset Formula $\rdeg_{-\vec{s}^{~\prime\prime}}\mathbf{G}^{\prime\prime}=-\vec{t}^{~\prime\prime}$
\end_inset

 is just a permutation of 
\begin_inset Formula $-\vec{t}$
\end_inset

 with the same entries.
 By the definition of shifted row degree, 
\begin_inset Formula $-\vec{t}^{~\prime\prime}$
\end_inset

 is the sum of 
\begin_inset Formula $-\vec{s}^{~\prime\prime}$
\end_inset

 and the list of the diagonal pivot degrees, which are nonnegative.
 Therefore, 
\begin_inset Formula $-\vec{t}^{~\prime\prime}\ge-\vec{s}^{~\prime\prime}$
\end_inset

.
 The result then follows as 
\begin_inset Formula $\vec{t}$
\end_inset

 is a permutation of 
\begin_inset Formula $\vec{t}^{~\prime\prime}$
\end_inset

 and 
\begin_inset Formula $\vec{s}^{\ \prime}$
\end_inset

 consists of the largest entries of 
\begin_inset Formula $\vec{s}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Having determined a bound on the column degrees of 
\begin_inset Formula $\mathbf{T}$
\end_inset

, we are now ready to compute 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
 This is done again by computing a kernel basis using an order basis computation
 as before.
 
\end_layout

\begin_layout Lemma
Let 
\begin_inset Formula $\vec{t}^{*}=\left[0,\dots,0,\vec{t}\right]\in\mathbb{Z}^{m+r}$
\end_inset

.
 Then any 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis has the form 
\begin_inset Formula $\begin{bmatrix}V\\
\bar{\mathbf{T}}
\end{bmatrix}$
\end_inset

, where 
\begin_inset Formula $V\in\mathbb{K}^{m\times m}$
\end_inset

 is a unimodular matrix and 
\begin_inset Formula $\left(\bar{\mathbf{T}}V^{-1}\right)^{T}$
\end_inset

 is a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 
\end_layout

\begin_layout Proof
Note first that the matrix 
\begin_inset Formula $\begin{bmatrix}-I~\\
~\mathbf{T}^{T}
\end{bmatrix}$
\end_inset

 is a kernel basis of 
\begin_inset Formula $\left[\mathbf{F}^{T},\mathbf{G}^{T}\right]$
\end_inset

 and is therefore unimodularly equivalent to any other kernel basis.
 Hence any other kernel basis has the form 
\begin_inset Formula $\begin{bmatrix}-I~\\
~\mathbf{T}^{T}
\end{bmatrix}U=\begin{bmatrix}V\\
\bar{\mathbf{T}}
\end{bmatrix}$
\end_inset

, with 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V=-U$
\end_inset

 unimodular.
 Thus 
\begin_inset Formula $\mathbf{T}=\left(\bar{\mathbf{T}}V^{-1}\right)^{T}$
\end_inset

.
 Also note that the 
\begin_inset Formula $-\vec{t}^{*}$
\end_inset

 minimality forces the unimodular matrix 
\begin_inset Formula $V$
\end_inset

 in any 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis to be of degree 0, the same degree as 
\begin_inset Formula $I$
\end_inset

.
 
\end_layout

\begin_layout Example
Let 
\begin_inset Formula 
\[
\mathbf{F}=\left[\begin{array}{cccc}
x^{2} & x^{2} & x+x^{2} & 1+x^{2}\\
1+x+x^{2} & x^{2} & 1+x^{2} & 1+x^{2}
\end{array}\right],
\]

\end_inset

a matrix over 
\begin_inset Formula $\mathbb{Z}_{2}[x]$
\end_inset

, and 
\begin_inset Formula 
\[
\mathbf{G}=\left[\begin{array}{cccc}
1 & 0 & 1 & 0\\
\noalign{\medskip}x & {x}^{2} & 0 & 1+{x}^{2}
\end{array}\right],
\]

\end_inset

a minimal left kernel basis of a right kernel basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 In order to compute the column basis 
\begin_inset Formula $\mathbf{T}$
\end_inset

 satisfying 
\begin_inset Formula $\mathbf{F}=\mathbf{T}\mathbf{G}$
\end_inset

, first we can determine 
\begin_inset Formula $\cdeg\mathbf{T}\le\vec{t}=\left[2,0\right]$
\end_inset

 from Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:colBasisdegreeBoundByRdegOfRightFactor"

\end_inset

.
 Then we can compute a 
\begin_inset Formula $\left[0,0,-\vec{t}\right]$
\end_inset

-minimal left kernel basis of 
\begin_inset Formula $\begin{bmatrix}\mathbf{F}\\
\mathbf{G}
\end{bmatrix}$
\end_inset

.
 The matrix 
\begin_inset Formula 
\[
\left[V,\bar{\mathbf{T}}\right]=\left[\begin{array}{cccc}
\noalign{\medskip}1 & 0 & x+{x}^{2} & 1\\
1 & 1 & 1+x & 0
\end{array}\right]
\]

\end_inset

is such a left kernel basis.
 A column basis can then be computed as 
\begin_inset Formula 
\[
\mathbf{T}=V^{-1}\bar{\mathbf{T}}=\left[\begin{array}{cc}
x+x^{2} & 1\\
1+{x}^{2} & 1
\end{array}\right].
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
qed
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
In order to compute a 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis, we can again use order basis computation as before, as we
 again have an order basis that contains a 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis.
 
\end_layout

\begin_layout Lemma
Any 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],\vec{s}+1,-\vec{t}^{*}\right)$
\end_inset

-order basis contains a 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis whose 
\begin_inset Formula $-\vec{t}^{*}$
\end_inset

-row degrees are bounded by 0.
 
\end_layout

\begin_layout Proof
As before, Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:orderbasisContainsKernelbasisGeneralized"

\end_inset

 can be used here.
 We just need to show that a 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis has 
\begin_inset Formula $-\vec{t}^{*}$
\end_inset

-row degrees no more than 
\begin_inset Formula $0$
\end_inset

.
 This follows from the fact that 
\begin_inset Formula $\rdeg_{-\vec{t}^{*}}\begin{bmatrix}I\\
\mathbf{T}^{T}
\end{bmatrix}\le0$
\end_inset

.
 
\end_layout

\begin_layout Standard
In order to compute a 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis efficiently, we notice that we have the same type of problem
 as in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:kernelBasisViaOrderBasisByRows"

\end_inset

 and hence we can again use Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:minimalKernelBasisReverse"

\end_inset

.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:costOfKernelBasisReversedForLeftFactor"

\end_inset

A 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis can be computed using 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:minimalKernelBasisReverse"

\end_inset

 with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

, where 
\begin_inset Formula $s=\xi/n$
\end_inset

 is the average column degree of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 as before.
 
\end_layout

\begin_layout Proof
Just use the algorithm with input 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],\vec{t}^{*},\xi\right)$
\end_inset

.
 We can verify the conditions on the input are satisfied.
 
\end_layout

\begin_deeper
\begin_layout Itemize
To see that 
\begin_inset Formula $\sum\rdeg_{\vec{t}^{*}}\left[\mathbf{F}^{T},\mathbf{G}^{T}\right]\le\xi$
\end_inset

, note that from 
\begin_inset Formula $\vec{t}=-\rdeg_{-\vec{s}}\mathbf{G}$
\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:columnDegreesRowDegreesSymmetry"

\end_inset

 that 
\begin_inset Formula $\cdeg_{\vec{t}}\mathbf{G}\le\vec{s}$
\end_inset

, or equivalently, 
\begin_inset Formula $\rdeg_{\vec{t}}\mathbf{G}^{T}\le\vec{s}$
\end_inset

.
 Since we also have 
\begin_inset Formula $\rdeg\mathbf{F}^{T}\le\vec{s}$
\end_inset

, it follows that 
\begin_inset Formula $\rdeg_{\vec{t}^{*}}\left[\mathbf{F}^{T},\mathbf{G}^{T}\right]\le\vec{s}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
The second condition 
\begin_inset Formula $\sum\vec{t}^{*}\le\xi$
\end_inset

 follows from 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:colBasisdegreeBoundByRdegOfRightFactor"

\end_inset

.
 
\end_layout

\begin_layout Itemize
The third condition holds since 
\begin_inset Formula $\begin{bmatrix}-I~\\
~\mathbf{T}^{T}
\end{bmatrix}$
\end_inset

 is a kernel basis with row degrees bounded by 
\begin_inset Formula $\vec{t}^{*}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Standard
With a 
\begin_inset Formula $\left(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],-\vec{t}^{*}\right)$
\end_inset

-kernel basis 
\begin_inset Formula $\begin{bmatrix}V\\
\bar{\mathbf{T}}
\end{bmatrix}$
\end_inset

 computed, a column basis is then given by 
\begin_inset Formula $\mathbf{T}~=~\left(\bar{\mathbf{T}}V^{-1}\right)^{T}$
\end_inset

.
\end_layout

\begin_layout Standard
The complete algorithm for computing a column basis is then given in Algorithm
 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:colBasis"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $\colBasis(\mathbf{F})$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:colBasis"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace smallskip
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex ALGORITHMIC
status open

\begin_layout Plain Layout
\begin_inset Flex INPUT
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex OUTPUT
status open

\begin_layout Plain Layout
a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace smallskip
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\vec{s}~~~:=\cdeg\mathbf{F}$
\end_inset

;
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{N}~~:=\mnb(\mathbf{F},\vec{s})$
\end_inset

;
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{G}:=\left(\mnbr(\mathbf{N}^{T},\vec{s},\sum\vec{s})\right)^{T}$
\end_inset

; 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\vec{t}^{*}:=\left[0,\dots,0,-\rdeg_{-\vec{s}}\mathbf{G}\right]$
\end_inset

, with 
\begin_inset Formula $\rowDimension(\mathbf{G})$
\end_inset

 
\begin_inset Formula $~~~~~~~~~~~$
\end_inset

 number of 0's ; 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout
\begin_inset Formula $\left[\begin{array}{c}
V\\
\bar{\mathbf{T}}
\end{array}\right]:=\mnbr(\left[\mathbf{F}^{T},\mathbf{G}^{T}\right],\vec{t}^{*},\sum\vec{s})$
\end_inset

 
\begin_inset Formula $~~~~~~~~~~~~~~~~$
\end_inset

 with a square 
\begin_inset Formula $V$
\end_inset

; 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Flex STATE
status open

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\mathbf{T}~~=\left(\bar{\mathbf{T}}V^{-1}\right)^{T}$
\end_inset


\series default
;
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
RETURN
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{T}$
\end_inset

; 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:columnBasisCost1"

\end_inset

A column basis 
\begin_inset Formula $\mathbf{T}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 can be computed with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

, where 
\begin_inset Formula $s=\xi/n$
\end_inset

 is the average column degree of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 as before.
 
\end_layout

\begin_layout Proof
The cost is dominated by the cost of the three kernel basis computations
 in the algorithm.
 The first one is handled by the algorithm from 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand formatted
reference "thm:costGeneral"

\end_inset

, while the remaining two are handled by 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:minimalKernelBasisReverse"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:costKernelBasisReverse"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand formatted
reference "lem:costOfKernelBasisReversedForLeftFactor"

\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:successiveColBasisComputation"

\end_inset

A Simple Improvement
\end_layout

\begin_layout Standard
When the input matrix 
\begin_inset Formula $\mathbf{F}$
\end_inset

 has column dimension 
\begin_inset Formula $n$
\end_inset

 much larger than the row dimension 
\begin_inset Formula $m$
\end_inset

, then we can separate 
\begin_inset Formula $\mathbf{F}=\left[\mathbf{F}_{1},\mathbf{F}_{2},\dots,\mathbf{F}_{n/m}\right]$
\end_inset

 into 
\begin_inset Formula $n/m$
\end_inset

 blocks, each with dimension 
\begin_inset Formula $m\times m$
\end_inset

, assuming without loss of generality 
\begin_inset Formula $n$
\end_inset

 is a multiple of 
\begin_inset Formula $m$
\end_inset

, and the columns are arranged in increasing degrees.
 We then do a series of column basis computations.
 First we compute a column basis 
\begin_inset Formula $\mathbf{T}_{1}$
\end_inset

 of 
\begin_inset Formula $\left[\mathbf{F}_{1},\mathbf{F}_{2}\right]$
\end_inset

.
 Then compute a column basis 
\begin_inset Formula $\mathbf{T}_{2}$
\end_inset

 of 
\begin_inset Formula $\left[\mathbf{T}_{1},\mathbf{F}_{3}\right]$
\end_inset

.
 Repeating this process, at step 
\begin_inset Formula $i$
\end_inset

, we compute a column basis 
\begin_inset Formula $\mathbf{T}_{i}$
\end_inset

 of 
\begin_inset Formula $\left[\mathbf{T}_{i-1},\mathbf{F}_{i+1}\right]$
\end_inset

, until 
\begin_inset Formula $i=n/m-1$
\end_inset

, when a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is computed.
 
\end_layout

\begin_layout Lemma
Let 
\begin_inset Formula $\bar{s}_{i}=\left(\sum\cdeg\mathbf{F}_{i}\right)/m$
\end_inset

.
 Then at step 
\begin_inset Formula $i$
\end_inset

, computing a column basis 
\begin_inset Formula $\mathbf{T}_{i}$
\end_inset

 of 
\begin_inset Formula $\left[\mathbf{T}_{i-1},\mathbf{F}_{i+1}\right]$
\end_inset

 can be done with a cost of 
\begin_inset Formula $O^{\sim}\left(m^{\omega}(\bar{s}_{i}+\bar{s}_{i+1})/2\right)$
\end_inset

 field operations.
\end_layout

\begin_layout Proof
From Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:colBasisdegreeBoundByRdegOfRightFactor"

\end_inset

, the column basis 
\begin_inset Formula $\mathbf{T}_{i-1}$
\end_inset

 of 
\begin_inset Newline newline
\end_inset


\begin_inset Formula $\left[\mathbf{F}_{1},\dots,\mathbf{F}_{i}\right]$
\end_inset

 has column degrees bounded by the largest column degrees of 
\begin_inset Formula $\mathbf{F}_{i}$
\end_inset

, hence 
\begin_inset Formula $\sum\cdeg\mathbf{T}_{i-1}\le\sum\cdeg\mathbf{F}_{i}$
\end_inset

.
 The lemma then follows by combining this with the result from Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:columnBasisCost1"

\end_inset

 that a column basis 
\begin_inset Formula $\mathbf{T}_{i}$
\end_inset

 of 
\begin_inset Formula $\left[\mathbf{T}_{i-1},\mathbf{F}_{i+1}\right]$
\end_inset

 can be computed with a cost of 
\begin_inset Formula $O^{\sim}\left(m^{\omega}\hat{s}_{i}\right)$
\end_inset

, where 
\begin_inset Formula 
\[
\hat{s}_{i}=\left(\sum\cdeg\mathbf{T}_{i-1}+\sum\cdeg\mathbf{F}_{i+1}\right)/2m\le\frac{\left(\bar{s}_{i}+\bar{s}_{i+1}\right)}{2}.
\]

\end_inset


\end_layout

\begin_layout Theorem
If 
\begin_inset Formula $s=\left(\sum\cdeg\mathbf{F}\right)/n$
\end_inset

, then 
\begin_inset CommandInset label
LatexCommand label
name "thm:finalCollBasisCost"

\end_inset

 a column basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 can be computed with a cost of 
\begin_inset Formula $O^{\sim}\left(m^{\omega}s\right)$
\end_inset

.
 
\end_layout

\begin_layout Proof
Summing up the cost of all the column basis computations, 
\begin_inset Formula 
\begin{eqnarray*}
 &  & \sum_{i=1}^{n/m-1}O^{\sim}\left(m^{\omega}\left(\bar{s}_{i}+\bar{s}_{i+1}\right)/2\right)\\
 &  & ~~~\subset O^{\sim}\left(m^{\omega}\left(\sum_{i=1}^{n/m}\bar{s}_{i}\right)\right)=O^{\sim}\left(nm^{\omega-1}s\right),
\end{eqnarray*}

\end_inset

since 
\begin_inset Formula $\sum\cdeg\mathbf{F}=\sum_{i=1}^{n/m}\left(m\bar{s}_{i}\right)=ns.$
\end_inset


\end_layout

\begin_layout Remark
In this section, the computational efficiency is improved by reducing the
 original problem to about 
\begin_inset Formula $n/m$
\end_inset

 subproblems whose column dimensions are close to the row dimension 
\begin_inset Formula $m$
\end_inset

.
 This is done by successive column basis computations.
 Note that we can also reduce the column dimension by using successive order
 basis computations, and only do a column basis computation at the very
 last step.
 The computational complexity of using order basis computation to reduce
 the column dimension would remain the same, but in practice it may be more
 efficient since order basis computations are simpler.
 
\end_layout

\begin_layout Section
Conclusion
\end_layout

\begin_layout Standard
In this paper we have given a fast, deterministic algorithm for the computation
 of a column basis for 
\begin_inset Formula $\mathbf{F}$
\end_inset

 having complexity 
\begin_inset Formula $O^{\sim}\left(n^{\omega}s\right)$
\end_inset

 field operations in 
\begin_inset Formula $\mathbb{K}$
\end_inset

 with 
\begin_inset Formula $s$
\end_inset

 an upper bound for the average column degree of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Our methods rely on a special factorization of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 into a column basis and a kernel basis.
 These in turn are computed via fast kernel basis and fast order basis algorithm
 of 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012,ZL2012"

\end_inset

.
 When these computations involve the multiplication of polynomial matrices
 with unbalanced degrees then they use the fast method for such multiplications
 given in 
\begin_inset CommandInset citation
LatexCommand cite
key "za2012"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%For some applications of column basis computation, including efficient
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%deterministic computations of matrix determinant, Hermite form, and
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%computations of column reduced form and Popov form for matrices of
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%any rank and any dimension, we refer the readers to the thesis 
\backslash
cite{zhou:phd2012}.
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

In a later publication we will show how this column basis algorithm can
 be used in efficient deterministic computations of matrix determinant,
 Hermite form, and computations of column reduced form and Popov form for
 matrices of any rank and any dimension.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%
\backslash
bibliographystyle{plainnat}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "paper"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
